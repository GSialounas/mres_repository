\documentclass[12pt,a4paper]{article}
\usepackage{listings,chngcntr}
\usepackage{hyperref}% http://ctan.org/pkg/hyperref
\usepackage{paralist}
\usepackage{enumitem}% http://ctan.org/pkg/enumitem
\usepackage{amssymb}
\usepackage{amsmath,amsfonts,bm}
\usepackage{amsthm}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{definition}[theorem]{Definition}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\usepackage{url}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{indentfirst}
\usepackage[percent]{overpic}
\makeatletter
\def\BState{\State\hskip-\ALG@thistlm}
\makeatother
\usepackage{mathtools}
\usepackage{fancyhdr}
\pagestyle{fancy}
\theoremstyle{definition}
\usepackage{float}
\usepackage[utf8]{inputenc}
\usepackage{cleveref}
\crefname{section}{§}{§§}
\Crefname{section}{§}{§§}
\newcommand{\R}{\mathbb{R}}
 \usepackage{stmaryrd}
 \usepackage{graphicx}
 \usepackage{caption}
 \usepackage{subcaption}
 \usepackage[english]{babel}




\usepackage{listings}
\usepackage{color}
\usepackage{graphicx, epstopdf}
\usepackage{listings}
\lstset{language=Python}
\renewcommand{\sectionautorefname}{\S}
\setlength{\topmargin}{0.0in}
\setlength{\oddsidemargin}{0.33in}
\setlength{\textheight}{9.0in}
\setlength{\textwidth}{6.0in}
\renewcommand{\baselinestretch}{1.25}
\setlist[itemize]{noitemsep, topsep=0pt}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\lstset{
	frame=single,
	numbers = left,
	basicstyle=\fontsize{9}{11}\ttfamily\linespread{0.85}\ttfamily,
    breaklines=true
}
\title{Hierarchical Model Adaptivity}
\author{Author: Georgios Sialounas}

\begin{document}
\counterwithin{lstlisting}{section}
\maketitle
\thispagestyle{empty}
\newpage
\tableofcontents
\thispagestyle{empty}
\newpage
\setcounter{page}{1}


\section{Introduction and Motivation}

It is often the case when modelling physical phenomena that we need to solve a complicated Partial Differential Equations (PDE).  This may result in linear systems which are computationally expensive to solve.  One way to overcome this difficulty is to use some physical reasoning to simplify the model.  The justification is that the simpler model describes the physical system adequately even with the loss of information incurred through the simplification.  

Situations calling for such simplifications abound.  As an example consider oceanic flow the flow of water is governed by the Navier-Stokes equations.  However, if we are interested for the flow away from fixed boundaries where viscocity is not important, one can accurately describe the flow with the Euler equations.

The natural problem with this approach are cases in which we actually do need to make use of the complex model in a small part of the domain in order to produce reliable, accurate results.   The mathematical challenge that arises is in the coupling of the simple and complex models so that we retain the savings from using the former in the majority of the domain and the accuracy from using the latter in specific parts of the domain as necessary.

This model refinement can be based on knowledge available $\textit{a priori}$, which informs the decomposition of the domain or on results made available $\textit{a posteriori}$, i.e. during the computation, after each iteration of the algorithm.

The aim of this project will be to develop a strategy to adaptively choose an appropriate model to approximate over specific parts of the domain in real time.  The specific example we will consider is flow governed by Stokes equations, to be reduced to the vectorial Laplacian in parts of the domain where pressure is constant.  The reduction will be based on localised error estimates.  We will examine the errors due to numerical approximation and also due to the model reduction itself.

The rest of the project is structured as follows.  In \S \ref{sec_obj} we present the work we intent to complete by the end of the project.  In \S \ref{sec_mathform} we describe Stokes's equations, introduce their weak form and show that the resulting problem is well-posed.  In \S \ref{sec_adaptivity} we  describe adaptivity and how it will be implemented in this project in greater depth.  In \S \ref{sec_numerics} we present some preliminary results that are produced with the Deal.II software (see \cite{BangerthHartmannKanschat2007}), which  will be used for the numerical implementation component of the project.  We conclude the report in \S \ref{sec_conclusion}, where we also discuss the next steps.

\section{Objectives}\label{sec_obj}
The objectives presented in this section pertain to the entirety of the project and not just to the work presented in this work.  They are essentially a breakdown of the work that must be done in order to  Briefly, our aims for the rest of the project are the following:
\begin{itemize}
\item Mathematical analysis of the system that arises from a discretisation of the Stokes equations.
\item Obtain error bounds (a-posteriori) for the Stokes problem.
\item Implement the simple Stokes model in Deal.II.
\item Mathematical analysis of the system that arieses from a discretisation of the adaptive Stokes case.
\item A-posteriori error bounds for the adaptive Stokes
\item Implementation of the adaptive Stokes in Deal.II.
\end{itemize}

\section{Mathematical Formulation}\label{sec_mathform}
In this section we present Stokes's equations and their weak form.   These are used to describe very slow flows (in the limit as the Reynold's number tends to zero).  Such flows might include the motion of the fluid very close to a solid boundary or the flow of magma in the Earth's mantle.  
\subsection{Stokes Equations}
Stoke's problem in a domain $\Omega = \left[0,1\right]^2 \subset \mathbb{R}^2$ involves finding $\left(\textbf{u},p\right)$ such that:
\begin{equation}\label{stokes_eq}
\begin{aligned}
	-\Delta\textbf{u} + \nabla p &= \textbf{f} \\ 
	\nabla\cdot \textbf{u}&= 0\\ 
\textbf{u}|_{\partial\Omega}&=0 
\end{aligned}
\end{equation}
where boldface indicates vectors.  In (\ref{stokes_eq}), $\textbf{u},\, \textbf{f}$ and $p$ represent the velocity, the forcing and the pressure respectively.  In this case we have used zero (Dirichlet) boundary conditions. 
\subsection{Weak Formulation}\label{weak-form-stokes}
We obtain the weak form of (\ref{stokes_eq}) by multiplying the equations with test functions $\textbf{v}$ and $q$ and integrating by parts.  This gives us:
\begin{eqnarray}\label{form-a}
	a\left(\textbf{u},\textbf{v}\right) + b\left(\textbf{v},p\right) &=& F\left(\textbf{v}\right)\quad \forall 
\textbf{v} \in \mathbb{V} \text{ and} \\\label{form-b}
	b\left(\textbf{u},q\right)&=&0 \quad \quad\quad\forall q \in \mathbb{P},
\end{eqnarray}
where 
\begin{eqnarray}\label{weak-a}
	a\left(\textbf{u},\textbf{v}\right)&=&\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v}, \\\label{weak-b}
	b\left(\textbf{v},q\right) &=& \int_{\Omega}-q\left(\nabla \cdot \textbf{v}\right) \text{ and}\\\label{weak-F}
    F\left(\textbf{v}\right) &=& \int_{\Omega}\textbf{f}\cdot \textbf{v} ,
\end{eqnarray}
The function spaces $\mathbb{V}$ and $\mathbb{P}$ are defined as follows:
\begin{eqnarray}\label{fspace_V}
\mathbb{V}&=&\textbf{H}^1_0\left(\Omega\right)^2\text{, with norm: } \left|\textbf{v}\right|_{1}=\left|\left|\nabla\textbf{v}\right|\right|_{L^2\left(\Omega\right)}, \\\label{fspace P}
\mathbb{P}&=&L^2_0\left(\Omega\right)=\left\lbrace q\in L^2\left(\Omega\right): \int_\Omega q=0\right\rbrace\text{, with norm: } \left|\left|q\right|\right|_{L^2\left(\Omega\right)}
\end{eqnarray}
Note that by the $(\cdot)^2$ in $\textbf{H}^{1}_{0}\left(\Omega\right)^2$ we indicate that we are dealing with vectorial functions with two components. Henceforth, we will adopt the notation $\left|\textbf{u}\right|_1$ and $\left|\left|q\right|\right|_{L^2}$ for the norms pertaining to the function spaces specified in (\ref{fspace_V}) and (\ref{fspace P}).  The reader should take it for granted that the quantity is taken over the domain $\Omega$ rather than just, say, the boundary $\partial \Omega$, unless the context explicitly specifies otherwise.
\subsection{Well Posedness}\label{sec_wellposed}
We will introduce some notation that will be used for the analysis in this section.  We will adopt the same notation as \cite{Chen2016} for ease of cross-checking, as the analysis in this section relies heavily on results presented therein. 
We will also be frequently making use of the symbol
\begin{equation}
	\lesssim \nonumber,
\end{equation}
which we we will define as follows: if $a\lesssim b$ this means $a\leq C\cdot b$, with $C>0$.  We will also define two important concepts in terms of proving well-posedness: coercivity and boundedness.
\theoremstyle{definition}
\begin{definition}{$\textbf{Coercivity and boundedness}$} (see \cite{brenner2007mathematical}: Definition 2.5.2)
	An (abstract) bilinear form $a\left(\cdot,\cdot\right)$ on a normed linear space $H$ is said  to be bounded (or continuous) if $\exists C > 0$ such that
	\begin{equation}
		\left|a\left(u,v\right)\right|\leq C \left|\left|u\right|\right|_H\left|\left|v\right|\right|_H \quad \forall u,v \in H\nonumber
	\end{equation}
	and coercive on $V\subset H$ if $\exists$ $\alpha > 0$ such that
	\begin{equation}
	a\left(v,v\right)\geq \alpha \left|\left|v\right|\right|_H^2\quad \forall v \in V\nonumber.
	\end{equation}
\end{definition}
\subsubsection{PDE}\label{PDE_cont}
There are four components to proving the well-posedness of (\ref{stokes_eq}):
	 \begin{eqnarray}\label{coerc_a}
	\inf_{\textbf{u}\in \mathbb{V}}\sup_{\textbf{v}\in \mathbb{V}}\frac{a\left(\textbf{u},\textbf{v}\right)}{\left|\textbf{u}\right|_1 \left|\textbf{v}\right|_1}&=&\alpha>0,\\\label{coerc_b}
			\inf_{q\in \mathbb{P}}\sup_{\textbf{u}\in \mathbb{V}}\frac{b\left(\textbf{u},q\right)}{\left|\textbf{u}\right|_1 \left|\left|q\right|\right|_{L^2}}&=&\beta>0,\\\label{cont_a}
		a\left(\textbf{u},\textbf{v}\right)&\leq& C_a\left|\textbf{u}\right|_1\left|\textbf{v}\right|_1,\, \forall \textbf{u},\textbf{v} \in \mathbb{V}\text{ and}\\\label{cont_b}
		b\left(\textbf{u},q\right)&\leq& C_b\left|\textbf{u}\right|_1\left|\left|q\right|\right|_{L^2},\,\forall \textbf{u} \in \mathbb{V},\, q \in \mathbb{P}.
	\end{eqnarray}
Briefly, (\ref{coerc_a}) and (\ref{coerc_b}) correspond to the stability of the bi-linear forms specified in (\ref{weak-a}) and (\ref{weak-b}) respectively, while (\ref{cont_a}) and (\ref{cont_b}) correspond to their boundedness, in the same order. It is worth noting that (\ref{coerc_a}) is perhaps more widely known as the $\textit{inf-sup}$ condition (see \cite{brenner2007mathematical}: \S 12). It is relatively easier to show that conditions (\ref{coerc_b}), (\ref{cont_a}) and (\ref{cont_b}) hold than to show (\ref{coerc_a}) holds, so we will start with the latter.  However, firstly we will introduce a result that implies (\ref{coerc_b}) holds.  The result can be found in \cite{Chen2016} as Lemma 1.4.
\begin{lemma}\label{Lemma_equiv}
	For any $q\in L^2_0\left(\Omega\right), \exists \textbf{v}\in \textbf{H}^1_0\left(\Omega\right)$ such that
	\begin{equation}
		\nabla \cdot \left(\textbf{v}\right) = q \text{ and } \left|\textbf{v}\right|_1 \lesssim \left|\left|q\right|\right|_{L^2}\nonumber.
	\end{equation}
	Consequently, the inf-sup condition, (\ref{coerc_b}), holds.
\end{lemma}
\begin{proof}
	See \cite{Chen2016}: Lemma 1.4
\end{proof}
We will use the statement of Lemma \ref{Lemma_equiv} to show it implies (\ref{coerc_b}).  Consider (\ref{weak-b}).  We choose $\textbf{v}$ so that the result in Lemma (\ref{Lemma_equiv}) holds. We will label this $\textbf{v}$ as $\textbf{v}_q$ to remember the dependence on $q$.   Hence
\begin{eqnarray}
b\left(\textbf{v}_q,q\right) &=& \left|\left|q\right|\right|_{L^2}^2 \quad\text{by Lemma \ref{Lemma_equiv}  and defn of } \nonumber \left|\left|\cdot\right|\right|_{L^2},\\
&\gtrsim& \left|\left|q\right|\right|_{L^2} \left|\textbf{v}_q\right|_1\quad \text{by Lemma \ref{Lemma_equiv}}.\nonumber
\end{eqnarray}
Now, assuming that $\left|\textbf{v}_q\right|_1$, which we assume not to be zero and take the supremum over $\textbf{v}\in \mathbb{V}$ to get:
\begin{equation}
\sup_{\textbf{0}\neq\textbf{v}\in \mathbb{V}}\frac{b\left(\textbf{v},q\right)}{\left|\textbf{v}\right|_1} \gtrsim \left|\left|q\right|\right|_{L^2}.\nonumber
\end{equation}
Now we divide throughout by $\left|\left|q\right|\right|$, which we also assume not to be equal to zero, and take the $\inf$ of that, which we can do since the inequality is required to hold for all $q\in \mathbb{P}$:
\begin{equation}
\inf_{q\in \mathbb{P}}\frac{1}{\left|\left|q\right|\right|_{L^2}}\sup_{\textbf{v}\in \mathbb{V}}\frac{b\left(\textbf{v},q\right)}{\left|\textbf{v}\right|_1} \gtrsim 1 \nonumber.
\end{equation}
Lastly, since $q$ does not depend on the choice of $\textbf{v}$, we can move it inside the supremum to obtain the required result, i.e. (\ref{coerc_b}) $\qedsymbol$ .  

Next, we show that (\ref{coerc_a}) holds.  This is implied by the fact that (\ref{weak-a}) is coercive:
\begin{eqnarray}
		a\left(\textbf{u},\textbf{u}\right)&=&\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v}\;\mathrm{d}x,\nonumber\\
		&=&\int_{\Omega}\sum_{i}\nabla u_i \cdot \nabla u_i\;\mathrm{d}x\text{ and}\nonumber\\
		&=&\left|\textbf{u}\right|_1^2,\nonumber
\end{eqnarray}
which is the coercivity condition with equality and $\alpha = 1$.  Now we show that  the coercivity of $a\left(\cdot,\cdot\right)$ implies (\ref{coerc_a}.  Since $a\left(\cdot,\cdot\right)$ is coercive, we have that
\begin{equation}
a\left(\textbf{u},\textbf{u}\right)\geq \alpha  \left|\textbf{u}\right|_1^2 \nonumber.
\end{equation}
We divide throughout by $\left|\textbf{u}\right|_1$, which we assume not to be zero. 
\begin{equation}
\frac{a\left(\textbf{u},\textbf{u}\right)}{\left|\textbf{u}\right|_1}\geq \alpha \left|\textbf{u}\right|_1 \nonumber
\end{equation}
 Then we take the supremum on the left-hand side over all $\textbf{v}\in\mathbb{V}$:
 \begin{equation}
 \sup_{\textbf{v}\in \mathbb{V}}\frac{a\left(\textbf{u},\textbf{v}\right)}{\left|\textbf{v}\right|_1}\geq \alpha \left|\textbf{u}\right|_1\nonumber
 \end{equation}
 Since this result hold for any $\textbf{u}\in \mathbb{V}$ then it also holds for the infimum over $\textbf{u}$:
\begin{equation}
\inf_{\textbf{u}\in \mathbb{V}}\sup_{\textbf{v}\in \mathbb{V}}\frac{a\left(\textbf{u},\textbf{v}\right)}{\left|\textbf{v}\right|_1\left|\textbf{u}\right|_1} \geq \alpha>0\nonumber.
\end{equation}
Lastly, (\ref{cont_a}) and (\ref{cont_b}) follow from an application of the Cauchy-Schwarz inequality on the corresponding bilinear forms.
\subsubsection{Discrete form of the $\textit{inf-sup}$ condition}\label{PDE_disc}
In \S \ref{PDE_cont} we consider (\ref{weak-a}) and \ref{weak-b} in the setting of infinite-dimensional function spaces.  In practice we will be dealing with a finite-dimensional version of these.  Hence, we need to show that the discrete, finite-dimensional problem is also well-posed:
\begin{eqnarray}
		a\left(\textbf{u}_h,\textbf{v}\right) + b\left(\textbf{v},p_h\right) &=& F\left(\textbf{v}\right)\quad \forall 
	\textbf{v} \in \mathbb{V}_h \text{ and} \\
	b\left(\textbf{u}_h,q\right)&=&0 \quad \quad\quad\forall q \in\mathbb{P}_h,
\end{eqnarray}
where $\mathbb{V}_h\subset\mathbb{V}$ and $\mathbb{P}_h\subset\mathbb{P}$.  In this case, the discrete version of the $\textit{inf-sup}$ condition, (\ref{coerc_b}), is given by
\begin{equation}\label{coerc_b_disc}
	\inf_{q\in \mathbb{P}_h}\sup_{\textbf{u}\in \mathbb{V}_h}\frac{b\left(\textbf{u},q\right)}{\left|\textbf{u}\right|_1 \left|\left|q\right|\right|_{L^2}}=\beta>0.
\end{equation}
In order to show that (\ref{coerc_b_disc}) holds we will first introduce some results and definitions. Firstly, we define the Fortin operator:
\theoremstyle{definition}
\begin{definition}{Fortin Operator} (\cite{Chen2016}: Definition 2.1)\label{Fortin_defn}
	A linear operator $\Pi_h: \mathbb{V} \rightarrow \mathbb{V}_h$ is called a Fortin Operator if:
	\begin{enumerate}
	\item$b\left(\Pi_h v, q_h\right)=b\left(v, q_h\right)\quad \forall q_h \in \mathbb{P}_h,$
	\item $\left|\left|\Pi_h v\right|\right|_{\mathbb{V}}\leq C\left|\left|v\right|\right|_\mathbb{V}.$
	\end{enumerate}
\end{definition}
\begin{theorem}\label{theorem_inf_sup_disc}
	Assume the continuous inf-sup condition, (\ref{coerc_b}) holds and there exists a Fortin Operator $\Pi_h$, then the discrete inf-sup condition (\ref{coerc_b_disc}) holds.
\end{theorem}
\begin{proof}
	Since the continuous $\textit{inf-sup}$ condition (\ref{coerc_b}) holds then we know from Lemma \ref{Lemma_equiv} that for any $q\in \mathbb{P}_h \subset \mathbb{P}$ $\exists \textbf{v}\in \mathbb{V}$ such that
	\begin{equation}
		b\left(\textbf{v}, q_h\right)\geq \beta \left|\textbf{v}\right|_1\left|\left|q_h\right|\right|_{L^2} \text{ and } \left|\textbf{v}\right|_1 \lesssim \left|\left|q_h\right|\right|_{L^2}. \nonumber
	\end{equation} 
We have assumed that $\exists$ $\Pi_h$ and from item 1 of this definition we can choose $\textbf{v}=\Pi_h \textbf{v}\in \mathbb{V}_h$ such that
\begin{equation}
	b\left(\Pi_h\textbf{v},q_h\right) =b \left(\textbf{v},q_h\right). \nonumber
\end{equation}
Since (\ref{coerc_b}) holds, we have that
\begin{eqnarray}
b \left(\textbf{v},q_h\right)&\geq& \beta \left|\textbf{v}\right|_1\left|\left|q_h\right|\right|_{L^2} \nonumber \\
&\geq& \frac{\beta}{C} \left|\Pi_h\textbf{v}\right|_1\left|\left|q_h\right|\right|_{L^2}\quad \text{from item 2 of Definition \ref{Fortin_defn}}. \nonumber
\end{eqnarray}
Hence, the discrete $\textit{inf-sup}$ condition holds.
\end{proof}
\subsubsection{Stability bounds}\label{sec_stability_bounds}
The last ingredient we need for well-posedness is stability.  In the case of the continuous problem, we use (\ref{coerc_a})-(\ref{cont_b}) to show that a solution to (\ref{stokes_eq}) is stable. Firstly, we let 
\begin{equation}
	\textbf{v}=\textbf{u},\, q =p
\end{equation}
so that (\ref{form-a}) and (\ref{form-b}) respectively become
\begin{eqnarray}\label{nform-a}
\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{u}+\left(\nabla \cdot \textbf{u}\right)p\;\mathrm{d}x  &=&\int_{\Omega}\textbf{f}\cdot \textbf{u} \;\mathrm{d}x
 \text{ and} \\\label{nform-b}
\int_{\Omega}\left(\nabla \cdot \textbf{u}\right)p\;\mathrm{d}x&=& 0.
\end{eqnarray}
We now substitute (\ref{nform-b}) in (\ref{nform-a}) to obtain
\begin{equation}
\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{u}\;\mathrm{d}x  =\int_{\Omega}\textbf{f}\cdot \textbf{u} \;\mathrm{d}x.
\end{equation}
Notice that the left-hand side is equal to $\left|\textbf{u}\right|_1^2$.  We apply the Cauchy-Schwarz inequality to get
\begin{equation}\label{cauchy-a}
\left|\textbf{u}\right|_1^2\leq\left|\left|\textbf{f}\right|\right|_{L^2}\left|\left|\textbf{u}\right|\right|_{L^2}.
\end{equation}
We would now like to bound the right-hand side such that we obtain a bound based on problem data.  We can do this by using Poincar\'e's inequality:
\begin{equation} 
\left|\left|\textbf{u}\right|\right|_{L^2}\leq C_p\left|\textbf{u}\right|_1\text{, } C_p>0
\end{equation}
Interested readers can find further details on this inequality and its applicability  in (e.g.) \cite{brenner2007mathematical}: \S 5.3.  We use this in (\ref{cauchy-a}) to get
\begin{equation}\label{cauchy-b}
\left|\textbf{u}\right|_1^2\leq C_p\left|\left|\textbf{f}\right|\right|_{L^2} \left|\textbf{u}\right|_1.
\end{equation}
Hence we obtain a bound on $\left|\textbf{u}\right|_1$, 
\begin{equation}\label{bound-u-cont}
\left|\textbf{u}\right|_1\leq C_p\left|\left|\textbf{f}\right|\right|_{L^2}.
\end{equation}
We now try to obtain a bound for $\left|\left|p\right|\right|_{L^2}$ in terms of the problem data, $\textbf{f}$.  The $inf-sup$ condition, (\ref{coerc_b}), implies that
\begin{equation}\nonumber
\beta \left|\left|q\right|\right|_{L^2}\leq \sup_{\textbf{v}\in \mathbb{V}, \,\left|\textbf{v}\right|_{L^2}\leq1}  b\left(\textbf{v},q\right)\quad  \forall q \in L^2
\end{equation}
We now choose $q=p$, which gives 
\begin{eqnarray}\nonumber
\beta \left|\left|p\right|\right|_{L^2} &\leq& \sup_{\textbf{v}\in \mathbb{V}, \,\left|\textbf{v}\right|_1\leq1}  b\left(\textbf{v},p\right)\\\nonumber
&=& \sup \left(\int_{\Omega}\textbf{f}\cdot\textbf{v} -\nabla\textbf{u}:\nabla\textbf{v}\right)\\\nonumber
\text{Cauchy-Schwarz: }&\leq& \sup \left(\left|\left|\textbf{f}\right| \right|_{L^2} \left|\left|\textbf{v}\right|\right|_{L^2}+\left|\textbf{u}\right|_1 \left|\textbf{v}\right|_1\right)\\\nonumber
\text{Poincar\'e's: }&=&\sup \left[\left(C_p\left|\left|\textbf{f}\right| \right|_{L^2}+ \left|\textbf{u}\right|_1\right) \left|\textbf{v}\right|_1\right] \\\nonumber
\left|\textbf{v}\right|_1\leq 1\text{:} &\leq&C_p\left|\left|\textbf{f}\right| \right|_{L^2}+ \left|\textbf{u}\right|_1\\\nonumber
\text{Using }\left(\ref{bound-u-cont}\right):&\leq&2C_p\left|\left|\textbf{f}\right| \right|_{L^2}
\end{eqnarray}
Hence, we have also obtained a stability bound on $\left|\left|p\right|\right|_{L^2}$ :
\begin{equation}\label{bound-p-cont}
\left|\left|p\right|\right|_{L^2} \leq \frac{2C_p}{\beta}\left|\left|\textbf{f}\right|\right|_{L^2}.
\end{equation}
Bounds (\ref{bound-u-cont}) and (\ref{bound-p-cont}) show that the solution to (\ref{stokes_eq}) is stable:
\begin{equation}
\left|\textbf{u}\right|_1+\left|\left|p\right|\right|_{L^2} \leq\left( C_p+\frac{2C_p}{\beta}\right)\left|\left|\textbf{f}\right|\right|_{L^2}.
\end{equation}
In conclusion, in this section we have shown that our problem has a unique, stable solution.
\section{Adaptivity}\label{sec_adaptivity}
The main objective in this project is to develop a strategy for switching between Stokes equation and Poisson equation in different parts of our domain.  In this section we will consider a domain which is divided into sub-domains based on the equations governing the flow in each subdomain.  Specifically, we want to find $\left(\textbf{u},p\right)$ that satisfies:
\begin{equation}
	\begin{aligned}\label{stokes_eq_adapt}
\text{In $\Omega_{1}$: }  -\Delta\textbf{u} + \nabla p &= \textbf{f} \\ 
	\nabla\cdot \textbf{u}&= 0
	\end{aligned}
\end{equation}
\begin{equation}\label{poisson_eq_adapt}
\text{In $\Omega_{2}$: }-\Delta\textbf{u}= \textbf{f}
\end{equation}
with boundary conditions given by
\begin{equation}\label{bc_adapt}
	\textbf{u}= 0 \text{\quad on $\partial \Omega$}.
\end{equation}
The domain is shown in Figure \ref{fig_domain}.  Naturally, we would like to know whether the problem given by (\ref{stokes_eq_adapt})-(\ref{bc_adapt}) has a unique, stable solution.  In order to do this we will first derive the variational form for (\ref{stokes_eq_adapt})-(\ref{bc_adapt}) and then we will repeat some of the procedures from \S \ref{sec_wellposed} to show that our problem is well-posed.
\begin{figure}[H]
	\centering
	\begin{overpic}[width=0.6\textwidth]{domain}
		\centering
		\put (20,30) {\huge$\displaystyle\Omega_{1}$}
		\put (70,30) {\huge$\displaystyle\Omega_{2}$}
		\put (50,30) {\huge$\displaystyle\mathcal{I}$}
		\put (87,52) {\huge$\displaystyle\partial \Omega$}
		\put (54,11) {\huge$\displaystyle \textbf{n}_1$}
		\linethickness{1pt}
		\put(47,10){\color{red}\vector(1,0){10}}
		\put (54,11) {\huge$\displaystyle \textbf{n}_1$}
		\linethickness{1pt}
		\put(99,30){\color{red}\vector(1,0){10}}
		\put (106,31) {\huge$\displaystyle \textbf{n}_2$}
	\end{overpic}
	\caption{Domain for the adaptive problem, with subdomains $\Omega_{1}$ (Stokes equations), $\Omega_{2}$ (Poisson equation)and boundary $\partial \Omega$ with homogeneous Dirichlet boundary conditions. The interface $\mathcal{I}$ separates the part of the domain where we solve each of the two problems.  The unit vectors $\textbf{n}_1$ and $\textbf{n}_2$ are the outward normals to $\Omega_{1}$ and $\Omega_{2}$ respectively.}
	\label{fig_domain}
\end{figure} 
\subsection{Variational Form}
In this section we derive a variational form for (\ref{stokes_eq_adapt})-(\ref{poisson_eq_adapt}).  We begin by testing the first and second equations in  (\ref{stokes_eq_adapt}) with test functions $\textbf{v}\in \mathbb{V}$ and $q\in \mathbb{P}$, where  $\mathbb{V}$ and $\mathbb{P}$ have been defined in (\ref{fspace_V}) and (\ref{fspace P}) respectively. We integrate the resulting equations by parts to obtain:
\begin{equation}\label{weak_stokes_1}
\begin{aligned}
\int_{\Omega_1}\nabla \textbf{u}^{\left(1\right)} : \nabla \textbf{v}-p\left(\nabla \cdot \textbf{v}\right) +\int_{\mathcal{I}} p\textbf{v}\cdot \textbf{n}_1-\textbf{v}\cdot\left(\textbf{n}_1\cdot\nabla\textbf{u}^{\left(1\right)}\right) &=\int_{\Omega_1}\textbf{f}\cdot \textbf{v}  \quad \forall  \textbf{v}\in \mathbb{V}\\
\int_{\Omega_1}q\left(\nabla \cdot \textbf{u}^{\left(1\right)}\right) &= 0\quad \forall q\in \mathbb{P},
\end{aligned}
\end{equation}
for subdomain $\Omega_1$ and
\begin{equation}\label{weak_poisson}
\int_{\Omega_2}\nabla \textbf{u}^{\left(2\right)} : \nabla \textbf{v} - \int_{\mathcal{I}} \textbf{v}\cdot\left(\textbf{n}_2\cdot\nabla\textbf{u}^{\left(2\right)}\right)= \int_{\Omega_2}\textbf{f}\cdot \textbf{v}  \quad \forall  \textbf{v}\in \mathbb{V}
\end{equation}
for $\Omega_2$, where the unit vectors $\textbf{n}_1$ and $\textbf{n}_2$ are the outward normals to $\Omega_{1}$ and $\Omega_{2}$ respectively and $\nabla \textbf{u}^{\left(1\right)}$ and $\nabla \textbf{u}^{\left(2\right)}$ are the flux gradients in the two subdomains. Notice that the boundary integrals are taken over $\mathcal{I}$ rather than over $\partial \Omega_{1}$ and $\partial \Omega_{2}$ because $\textbf{v}=\textbf{0}$ on $ \partial \Omega = \partial \Omega_1\cup \Omega_{2}\setminus \mathcal{I}$.   

Before we proceed, we introduce a jump operator, which is simply a notational convenience for expressing the jump of a quantity across an discontinuity.  Consider a (vector) quantity, $\textbf{b}$ in a domain $\Omega$.   Furthermore, suppose that this curve is shared (e.g. as part of a boundary) by two subdomains such that the values of $\textbf{b}$ at either side of $e$ in each subdomain are $\textbf{b}^{\left(1\right)}$ and $\textbf{b}^{\left(2\right)}$. In our example case we may consider $e = \mathcal{I}$, the interface between the two subdomains shown in Figure \ref{fig_domain}.  Then, the jump accross $\mathcal{I}$ is given by:
\begin{equation}
\llbracket \textbf{u} \rrbracket \coloneqq \textbf{n}_1\cdot \textbf{u}^{\left(1\right)}+\textbf{n}_2\cdot  \textbf{u}^{\left(2\right)}.
\end{equation}
The next step is to combine (\ref{weak_stokes_1}) and (\ref{weak_poisson}) into a single variational form over the whole of $\Omega$:
\begin{equation}\label{weak_total}
\begin{aligned}
\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v}-\int_{\Omega_1}p\left(\nabla \cdot \textbf{v}\right) +\int_{\mathcal{I}} p\textbf{v}\cdot \textbf{n}_1-\textbf{v}\cdot\llbracket\nabla\textbf{u}\rrbracket &=\int_{\Omega}\textbf{f}\cdot \textbf{v} \quad \forall  \textbf{v}\in \mathbb{V}\\
\int_{\Omega_1}q\left(\nabla \cdot \textbf{u}\right) &= 0\quad \forall q\in \mathbb{P},
\end{aligned}
\end{equation}
Now we set $\textbf{v}=\textbf{u}$  and $q=p$ in (\ref{weak_total}).  The latter gives $\int_{\Omega_1}p\left(\nabla \cdot \textbf{u}^{\left(1\right)}\right)=0$.  Hence, (\ref{weak_total}) simplifies to:
\begin{equation}\label{reduced_weak_total}
	\left|\textbf{u}\right|_1^2 + \int_{\mathcal{I}}p\textbf{u}\cdot \textbf{n}_1-\textbf{u}\cdot\llbracket \nabla \textbf{u}\rrbracket =\int_{\Omega_1}\textbf{f}\cdot \textbf{v}.
\end{equation}
In order to proceed from this point we require that on $\mathcal{I}$
\begin{equation}
p\textbf{u}\cdot \textbf{n}_1-\textbf{u}\cdot \llbracket \nabla \textbf{u}\rrbracket=0.
\end{equation}
This simplification reduces (\ref{reduced_weak_total}) to 
\begin{equation}
\left|\textbf{u}\right|_1^2 =\int_{\Omega_1}\textbf{f}\cdot \textbf{v}.
\end{equation}
The procedure to obtain the stability bound for this equation is identical to that in \S \ref{sec_stability_bounds}.  This concludes our stability analysis.
\section{Deal.II}\label{sec_numerics}
Deal.II is a C++, open-source, finite element library which we will be using for the implementation of the computational aspects of this project.  As a benchmark we will be solving the following problem:
\begin{eqnarray}
\label{benchmark_u}
	\textbf{u}\left(\textbf{x}\right)&=&\begin{bmatrix}
	200x^2\left(1-x\right)^2y\left(1-y\right)\left(1-2y\right)  \\
	-200y^2\left(1-y\right)^2x\left(1-x\right)\left(1-2x\right)  
	\end{bmatrix} \text{ and}\\\label{benchmark_p}
	p &=& 10\left(x-1/2\right)^3y^2+\left(1-x\right)^3\left(y-1/2\right)^3,
\end{eqnarray}
where $\textbf{x}=\left(x,y\right)^T$.    We will substitute (\ref{benchmark_u}) and (\ref{benchmark_p}) as exact solutions (\ref{stokes_eq})to obtain the forcing $\textbf{f}$.  We will use this benchmark example to test for convergence in our model.
\subsection{Computational results}
We are solving (\ref{stokes_eq}) using Deal.II with an adaptive mesh.  Figure \ref{fig_stokes_sol}  shows the magnitude of $\textbf{u}$ plotted at each of 5 refinement cycles required to solve the problem for $\left(\textbf{u}, p\right)$ given by (\ref{benchmark_u}) and (\ref{benchmark_p}).  The convergence results are listed in Table \ref{tablebenchmark_convergence} and illustrated in Figure \ref{fig_errors}.
\begin{figure}[H]
	\centering
	\includegraphics[width=10cm]{stokes_cg_velocities}
	\caption{The magnitude of $\textbf{u}$ plotted at each refinement cycle to (\ref{stokes_eq}) with $\textbf{u}$ given by (\ref{benchmark_u}).}
	\label{fig_stokes_sol}
\end{figure}
\begin{table}[H]
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|} \hline
	refinement cycle & cells & dofs & $||p-p_h||_{L^2}$ & $||u-u_h||_{L^2}$ & $||u-u_h||_{H^1}$\\ \hline
0 & 64 & 679 & 5.1016e-02 & 1.0815e-02 & 4.4823e-01\\ \hline
1 & 136 & 1431 & 1.0905e-01 & 9.9175e-03 & 4.1524e-01\\ \hline
2 & 352 & 3635 & 9.7928e-02 & 7.1343e-03 & 2.9415e-01\\ \hline
3 & 856 & 8615 & 2.3689e-02 & 9.6017e-04 & 8.2062e-02\\ \hline
4 & 2128 & 21115 & 1.1988e-02 & 6.2091e-04 & 5.2756e-02\\ \hline
5 & 5128 & 50427 & 2.4096e-03 & 8.6223e-05 & 1.5147e-02\\ \hline
		\end{tabular}
	\caption{Convergence for $\textbf{u}$ and $p$ in different norms.}
	\label{tablebenchmark_convergence}
	\end{center}
\end{table}


\begin{figure}[H]
	\begin{subfigure}[b]{.45\linewidth}
		\includegraphics[width=\linewidth]{u_uh_L2}
		\caption{Velocity in $L^2$: $\left|\left|u-u_h\right|\right|_{L^2}$.}
		\label{fig_uL2}
	\end{subfigure}
	\begin{subfigure}[b]{.45\linewidth}
		\includegraphics[width=\linewidth]{u_uh_H1}
		\caption{Velocity in $H^1$: $\left|\left|u-u_h\right|\right|_{H^1}$.}
		\label{fig_uH1}
	\end{subfigure}
	\centering
	\begin{subfigure}[b]{.45\linewidth}
		\includegraphics[width=\linewidth]{p_h_L2}
		\caption{Pressure $L^2$: $\left|\left|p-p_h\right|\right|_{L^2}$.}
		\label{fig_pL2}
	\end{subfigure}
	\caption{loglog plots of errors }
	\label{fig_errors}
\end{figure}
\section{A-posteriori error Analysis}
The solution to (\ref{stokes_eq}) satisfies
\begin{equation}\label{stokes_cont_sat}
\begin{aligned}
 \int_{\Omega}\nabla\textbf{u}:\nabla\textbf{v}+p\nabla\cdot\textbf{v} &=\int_{\Omega}f\textbf{v} \quad \forall 
	\textbf{v} \in \mathbb{V}_h \text{ and} \\
	\int_{\Omega}q\nabla\cdot\textbf{u}&=0\quad \quad\quad\forall q \in\mathbb{P}_h,
	\end{aligned}
\end{equation}
while the solution to the discrete version satisfies
\begin{equation}\label{stokes_disc_sat}
\begin{aligned}
  \int_{\Omega}\nabla\textbf{u}_h:\nabla\textbf{v}+p_h\nabla\cdot\textbf{v} &=\int_{\Omega}f\textbf{v} \quad \forall 
 \textbf{v} \in \mathbb{V}_h \text{ and} \\
 \int_{\Omega}q\nabla\cdot\textbf{u}_h&=0\quad \quad\quad\forall q \in\mathbb{P}_h.
 \end{aligned}
\end{equation}
We express the true error for velocity and pressure as 
\begin{eqnarray}
	\textbf{e}_u &=& \textbf{u}-\textbf{u}_h,\\
	e_p &=& p-p_h.
\end{eqnarray}
Now we subtract (\ref{stokes_disc_sat}) from (\ref{stokes_cont_sat}) to get an equation in terms of the difference between the actual solution and the computed approximation.
\begin{equation}\label{stokes_disc_sat_2}\small
\begin{aligned}\small
\int_{\Omega}\nabla\left(\textbf{u}-\textbf{u}_h\right):\nabla\textbf{v}+\left(p-p_h\right)\nabla\cdot\textbf{v} &=\int_{\Omega}f\textbf{v} -\nabla\textbf{u}_h:\nabla\textbf{v}-p_h\nabla\cdot\textbf{v} \quad \forall 
\textbf{v} \in \mathbb{V}_h, \\
\int_{\Omega}q\nabla\cdot\left(\textbf{u}-\textbf{u}_h\right)&=0\quad \quad\quad\forall q \in\mathbb{P}_h.
\end{aligned}
\end{equation}
Observe that due the zero divergence requirement, the second equation in (\ref{stokes_disc_sat_2}) reduces to 
\begin{equation}
\int_{\Omega}-q\nabla\cdot\left(\textbf{u}_h\right)=0\quad \quad\quad\forall q \in\mathbb{P}_h.
\end{equation}
Now we choose $\textbf{v}=\textbf{u}-\textbf{u}_h$ and $q=p-p_h$ and substitute it in (\ref{stokes_disc_sat_2}) to get
\begin{eqnarray}\small
\begin{aligned}
\left|\textbf{u}-\textbf{u}_h\right|^2_{1}-\int_{\Omega}\left(p-p_h\right)\nabla\cdot\textbf{u}_h&=\int_{\Omega}f\left(\textbf{u}-\textbf{u}_h\right) -\nabla\textbf{u}_h:\nabla\left(\textbf{u}-\textbf{u}_h\right)-p_h\nabla\cdot\left(\textbf{u}-\textbf{u}_h\right)+\left(p-p_h\right)\nabla\cdot\textbf{u}_h, \\
\int_{\Omega}q\nabla\cdot\left(\textbf{u}-\textbf{u}_h\right)&=0\quad \quad\quad\forall q \in\mathbb{P}_h.
\end{aligned}
\end{eqnarray}
\section{A-posteriori 2}
\subsection{Upper bound}
Consider a bilinear form $A$ and a linear form $B$,
\begin{eqnarray}
	A&:&\left[\textbf{H}^1_0\right]^d\times\left[\textbf{H}^1_0\right]^d \rightarrow\mathbb{R}\text{ and}\\
B&:&\left[\textbf{H}^1_0\right]^d\times \left[\textbf{L}^2_0\right]\,\,\rightarrow\mathbb{R},
\end{eqnarray}
such that
\begin{eqnarray}
	A\left(\textbf{u},\textbf{v}\right)&\coloneqq& \int_{\Omega}\nabla\textbf{u}:\nabla \textbf{v}\text{ and}\\
	B\left(\textbf{v},q\right)&\coloneqq&-\int_{\Omega}q\,\text{div}\left(\textbf{v}\right).
\end{eqnarray}
The weak form of the Stokes equation is to find $\left(\textbf{u},p\right)\in \left[\textbf{H}^1_0\right]^d  \times \textbf{L}^2_0$ such that
\begin{equation}\label{weak_stokes}
\begin{rcases}
A\left(\textbf{u},\textbf{v}\right)+B\left(\textbf{v},p\right)&=F\left(\textbf{v}\right)\\
B\left(\textbf{u},q\right)&=0
\end{rcases}
\quad\forall \left(\textbf{v},q\right)\in \left[\textbf{H}^1_0\right]^d  \times \textbf{L}^2_0.
\end{equation}
The finite element approximation of this problem is to find $\left(\textbf{u}_h,p_h\right)\in \left[\mathbb{V}_1\right]^d  \times \mathbb{V}_2\eqqcolon\mathbb{W}$ such that
\begin{equation}\label{weak_stokes_approx}
\begin{rcases}
A\left(\textbf{u}_h,\textbf{v}_h\right)+B\left(\textbf{v}_h,p_h\right)&=F\left(\textbf{v}_h\right)\\
B\left(\textbf{u}_h,q_h\right)&=0
\end{rcases}
\quad\forall \left(\textbf{v}_h,q_h\right)\in \mathbb{W}.
\end{equation}
We now want to control the error for the velocity, $\textbf{e}_u$ and for the pressure, $e_p$.   At the moment we will just obtain an upper bound.  Let us begin by defining both the pressure and the velocity error:
\begin{eqnarray}\label{error_velocity}
\textbf{e}_u&=&\textbf{u}-\textbf{u}_h,\\\label{error_pressure}
e_p &=& p-p_h
\end{eqnarray}
In order to control this error we first choose $\textbf{v}=\textbf{v}_h\in\mathbb{V}_1$, $q=q_h\in\mathbb{V}_2$ in (\ref{weak_stokes}) and then we subtract (\ref{weak_stokes_approx}) from (\ref{weak_stokes}) to obtain
\begin{equation}\label{weak_stokes_approx_galerkin}
	\begin{rcases}
	A\left(\textbf{u}-\textbf{u}_h,\textbf{v}_h\right)+B\left(\textbf{v}_h,p-p_h\right)&=\textbf{0}\\
	B\left(\textbf{u}-\textbf{u}_h,q_h\right)&=0
	\end{rcases}\quad\forall \left(\textbf{v}_h,q_h\right)\in \mathbb{W}.
\end{equation}
This is just a way of saying that the error obeys Galerkin orthogonality.  We now want to change (\ref{weak_stokes_approx_galerkin}) to a form which is convenient in helping us establish a bound for the error.  We do this by manipulating the bilinear form $A$ and the linear form $B$:
\begin{equation}\small \label{weak_stokes_approx_error}
\begin{rcases}
A\left(\textbf{u}-\textbf{u}_h,\textbf{v}\right)+B\left(\textbf{v},p-p_h\right)&=A\left(\textbf{u}-\textbf{u}_h,\textbf{v}-\textbf{v}_h\right)+B\left(\textbf{v}-\textbf{v}_h,p-p_h\right)\\
B\left(\textbf{u}-\textbf{u}_h,q\right)&=B\left(\textbf{u}-\textbf{u}_h,q-q_h\right).
\end{rcases}\quad\forall \left(\textbf{v}_h,q_h\right)\in \mathbb{W}.
\end{equation}
In order to proceed we choose $\textbf{v}=\textbf{u}-\textbf{u}_h$ and $q=p-p_h$ in (\ref{weak_stokes_approx_error}).  This gives:
\begin{equation} \label{weak_stokes_error_bilinforms}
\begin{aligned}
\left|\textbf{u}-\textbf{u}_h\right|^2_1 &=A\left(\textbf{u}-\textbf{u}_h,\textbf{u}-\textbf{u}_h\right)-A\left(\textbf{u}-\textbf{u}_h,\textbf{v}_h\right)\\
														  &+B\left(\textbf{u}-\textbf{u}_h,p-p_h\right)-B\left(\textbf{v}_h,p-p_h\right)\\
														  &+B\left(\textbf{u}-\textbf{u}_h,p-p_h\right)-B\left(\textbf{u}-\textbf{u}_h,q_h\right)
\end{aligned}
\end{equation}
Now we make use of the error definitions (\ref{error_velocity}) and (\ref{error_pressure}) in (\ref{weak_stokes_error_bilinforms}) for convenience in the analysis that will follow:
\begin{equation} \label{weak_stokes_error_bilinforms_euep}
\begin{aligned}
\left|\textbf{e}_u\right|^2_1 &=A\left(\textbf{e}_u,\textbf{e}_u\right)-A\left(\textbf{e}_u,\textbf{v}_h\right)\\
&+B\left(\textbf{e}_u,e_p\right)-B\left(\textbf{v}_h,e_p\right)\\
&+B\left(\textbf{e}_u,e_p\right)-B\left(\textbf{e}_u,q_h\right).
\end{aligned}
\end{equation}
Let $\mathcal{I}_{\mathbb{V}_1}\textbf{e}_u$ and $\mathcal{I}_{\mathbb{V}_2}e_p$ be the approximations of $\textbf{e}_u$ and $e_p$  respectively in their associated finite element subspace.  Now let $\textbf{v}_h= \mathcal{I}_{\mathbb{V}_1}\textbf{e}_u$  and $q_h=\mathcal{I}_{\mathbb{V}_2}e_p$ in (\ref{weak_stokes_error_bilinforms_euep}) (and dropping the subspace subscripts from $\mathcal{I}_{\mathbb{V}_{\left(\cdot\right)}}$) to get 
\begin{equation} \label{weak_stokes_error_bilinforms_euIeu}
\begin{aligned}
\left|\textbf{e}_u\right|^2_1 &=A\left(\textbf{e}_u,\textbf{e}_u-\mathcal{I}\textbf{e}_u\right)\\
&+B\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u,e_p\right)\\
&+B\left(\textbf{e}_u,e_p-\mathcal{I}e_p\right).
\end{aligned}
\end{equation}
We will begin by trying to bound the first two terms in the R.H.S. of (\ref{weak_stokes_error_bilinforms_euIeu}).  Let $\mathcal{T}$ be the triangulation for our domain and let $K$ be an element in the domain. Then
\begin{equation} \small \label{weak_stokes_error_firsttwo}
\begin{aligned}
A\left(\textbf{e}_u,\textbf{e}_u-\mathcal{I}\textbf{e}_u\right)
+B\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u,e_p\right)&= \sum_{K\in\mathcal{T}}\int_{K}\nabla\textbf{e}_u\colon\nabla\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u\right)- e_p\nabla\cdot\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u\right).
\end{aligned}
\end{equation}
Also note that
\begin{equation} \small
\begin{aligned}
A\left(\textbf{u},\textbf{e}_u-\mathcal{I}\textbf{e}_u\right)
+B\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u,p\right)&= \sum_{K\in\mathcal{T}}\int_{K}\textbf{f}\cdot\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u\right).
\end{aligned}
\end{equation}
With this in mind, we can express (\ref{weak_stokes_error_firsttwo}) (after integrating by parts) as
\begin{equation}
\begin{aligned}
\sum_{K\in\mathcal{T}}\int_{K}\left(\textbf{f}+\Delta \textbf{u}_h-\nabla p_h\right)\cdot\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u\right)+&\int_{\partial K}\left[\left(p\textbf{I}-\nabla\textbf{u}\right)\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u\right)\right]\cdot\textbf{n}.
\end{aligned}
\end{equation}
We use this to obtain an upper bound on the terms on the r.h.s. of (\ref{weak_stokes_error_firsttwo}):
\begin{equation}\label{weak_stokes_firstuppbound}\small
\begin{aligned}
\text{(\ref{weak_stokes_error_firsttwo})}\leq\sum_{K\in\mathcal{T}}\left|\left|\textbf{f}+\Delta \textbf{u}_h-\nabla p_h\right|\right|_{L^2}\left|\left|\textbf{e}_u-\mathcal{I}\textbf{e}_u\right|\right|_{L^2} +\sum_{\gamma\in \partial \mathcal{P}}\left|\left|p\textbf{I}-\nabla\textbf{u}\right|\right|_{L^2\left(\gamma\right)}\left|\left|\textbf{e}_u-\mathcal{I}\textbf{e}_u\right|\right|_{L^2\left(\gamma\right)}.
\end{aligned}
\end{equation}
It is now worth introducing some theorems and notions that will help us obtain computable bounds from (\ref{weak_stokes_firstuppbound}).  We will firstly introduce the concept of a regular partition of our domain, $\Omega$.
\begin{definition}{$\textbf{Regular Partition of } \bm{\Omega}$ (see \cite{ainsworth2011posteriori}: \S1.3.3)}
	Let $\Omega$ be a polygonal domain with boundary $\partial \Omega$.  A finite element partition $\mathcal{P}$ of $\Omega$ is a collection $\left\{K\right\}$ such that:
	\begin{enumerate}
	\item The elements form a partition of the domain, that is, $\overline{\Omega}=\cup_{K\in\mathcal{P}}\overline{K}$.
	\item Each element is a triangle or convex quadrilateral contained in $\Omega$.
	\item Any nonempty intersection of (the closure) of each distinct pair of elements is either a single common vertex or a single common edge of both elements.
	\end{enumerate}
Denote the diameter of a triangle $K$ by $h_K$ and the diameter of the largest circle that may be inscribed in the triangle by $\rho_K$.  The regularity of the triangle is measured by the ratio
\begin{equation}
\kappa_K=h_K/\rho_K.\nonumber
\end{equation}
A partition of $\Omega$ is said to be regular if there exists $\kappa\in\mathbb{R}$ such that
\begin{equation}
\max_{K\in\Omega}\kappa_K\leq\kappa.\nonumber
\end{equation}
\end{definition}
Our next step is to introduce the concept of an element patch, $\widetilde{K}$.
\begin{definition}{$\textbf{Patch of elements}$} (See \cite{ainsworth2011posteriori}: \S 1.3.8)
	A patch, $\widetilde{K}$, of elements is defined to be the subdomain of $\Omega$ consisting of the element $K$ along with the elements sharing at least one common vertex with $K$:
	\begin{equation}
		\widetilde{K}=int\left\{\bigcup K', K' \in \mathcal{P}: \overline{K}'\cap\overline{K}\neq \emptyset \right\}.\nonumber
	\end{equation}
\end{definition}
Lastly, we include a theorem from \cite{ainsworth2011posteriori} which will help us obtain bounds on terms of the form $\left|\left|\textbf{e}_u-\mathcal{I}\textbf{e}_u\right|\right|_{L^2\left(\cdot\right)}$ appearing in (\ref{weak_stokes_firstuppbound}).
\begin{theorem}{(see \cite{ainsworth2011posteriori}: Theorem 1.7)}\label{theorem_twobounds}
	Let $r\in\left[1,\infty\right)$, and for a nonnegative $p\in\mathbb{Z}$ let $X$ denote the finite element subspace constructed on a regular partition $\mathcal{P}$ of the polygonal domain $\Omega$ into triangular or quadrilateral elements.  Let $s\in \left[0,1\right]$ and $t$ satisfy $s\leq t\leq p+1$. Then, there exists a bounded, linear operator $\mathcal{I}_X\colon W^{t,r}\left(\Omega\right)\rightarrow X$ and a constant $C\in \mathbb{R}$, which depends only on the regularity $\kappa$ of the partition, such that for all $u\in W^{t,r}\left(\Omega\right)$ and for all $K\in \mathcal{P}$ we have
	\begin{eqnarray}
		\left|u-\mathcal{I}_Xu\right|_{W^{s,r}\left(K\right)} &\leq & Ch_K^{t-s}\left|u\right|_{W^{t,r}\left(\widetilde{K}\right)}\quad\text{and}\nonumber\\
				\left|u-\mathcal{I}_Xu\right|_{W^{s,r}\left(\gamma\right)} &\leq &Ch_K^{t-s-\left(1/r\right)}\left|\left|u\right|\right|_{W^{t,r}\left(\widetilde{K}\right)},\nonumber
	\end{eqnarray}
	where $\gamma$ is any edge of the element $K$ and $\widetilde{K}$ denotes the patch of elements associated with $K$.  We can now use this to obtain bounds on $\left|\textbf{e}_u\right|_1$ in (\ref{weak_stokes_firstuppbound}).
\end{theorem}
Firstly, we choose  $\textbf{u}=\textbf{e}_u$ $r=2$, $s=0$ and $t=1$ in the bounds in Theorem \ref{theorem_twobounds}.  This gives us bounds on $\textbf{e}_u$ over a patch of elements:
\begin{eqnarray}
	\left|\textbf{e}_u-\mathcal{I}_X\textbf{e}_u\right|_{L^2\left(K\right)} &\leq & C_1h_K\left|\textbf{e}_u\right|_{H^1\left(\widetilde{K}\right)}\quad\text{and}\\
	\left|\textbf{e}_u-\mathcal{I}_X\textbf{e}_u\right|_{L^2\left(\gamma\right)} &\leq &C_2h_K^{0.5}\left|\left|\textbf{e}_u\right|\right|_{H^1\left(\widetilde{K}\right)}.
\end{eqnarray}
We substitute these bounds in (\ref{weak_stokes_firstuppbound}) to obtain
\begin{equation}\small
\begin{aligned}
\text{(\ref{weak_stokes_firstuppbound})}&\leq C\left|\left|\textbf{e}_u\right|\right|_{H^1\left(\Omega\right)}\left\{\sum_{K\in\mathcal{T}}h_K^2\left|\left|\textbf{f}+\Delta \textbf{u}_h-\nabla p_h\right|\right|^2_{L^2\left(K\right)} +\sum_{\gamma\in \partial \mathcal{P}}h_K\left|\left|\left[p\textbf{I}-\nabla\textbf{u}\right]\right|\right|_{L^2\left(\gamma\right)}^2\right\}^{1/2}
\end{aligned}
\end{equation}
We regroup this terms to obtain a bound which is summable over the elements:


\section{A-posteriori Verf{\"u}rth}
In this section we present an alternative a-posteriori analysis for the Stokes problem.  This approach is presented in \cite{verfurth2013posteriori} and there are some differences between it and what we did so far.  Namely,  we consider a norm on the tuple space $\mathbb{V}\times\mathbb{P}$.
Firstly, consider a bilinear mapping $B$ and a linear functional $\ell$.  We want to find $\phi\in X$ such that 
\begin{equation}\label{var_prob_verf}
	B\left(\phi,\psi\right)=\langle\ell,\psi\rangle_Y\quad \forall \psi \in Y.
\end{equation}
We now present conditions for the well-posedness of this problem.
\begin{proposition}{$\textbf{Well-posedness of (\ref{var_prob_verf})}$} (See \cite{verfurth2013posteriori}: \S 4.1.1: Proposition 4.1)\label{prop_well_pos_verf}
Assume that the space Y is reflexive, that
\begin{equation}
	\sup_{\phi \in X}B\left(\phi,\psi\right)>0
\end{equation}
holds for all $\psi\in Y\setminus \lbrace 0 \rbrace$ and that
\begin{equation}
	\inf_{\phi\in X\setminus \lbrace0\rbrace}\sup_{\psi \in Y\setminus \lbrace0\rbrace}\frac{B\left(\phi,\psi\right)>0}{\left|\left|\phi\right|\right|_X\left|\left|\psi\right|\right|_Y}=\beta > 0.
\end{equation}
Then (\ref{var_prob_verf}) admits a unique solution for every right-hand side $\ell\in Y^*$ - where $Y^*$ is the dual of $Y$- and the solution depends continuously on the right-hand side.
\end{proposition}
Next we present a saddle-point formulation of the Stokes problem.  We do this so that we can express our problem in a form which allows us to use Proposition \ref{prop_well_pos_verf} to show that it is well-posed.  Firstly we need to express our problem in terms of the framework presented in (\ref{var_prob_verf}).  In particular, we present the spaces, bilinear forms and linear functionals as well as the norms we will be using.
\begin{equation}\label{verf_eqns}
\begin{aligned}
X=Y&=\textbf{H}^1_0\left(\Omega\right)^d\times L^2_0\left(\Omega\right),\\
\left|\left|\left(\textbf{u},p\right)\right|\right|_X&=\left\lbrace \left|\left|\nabla\textbf{u}\right|\right|^2 + \left|\left|p\right|\right|^2\right\rbrace^{1/2},\\
B\left(\left(\textbf{u},p\right),\left(\textbf{v},q\right)\right)&=\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v} - \int_{\Omega} p \nabla\cdot\textbf{v} + \int_{\Omega} q \nabla\cdot\textbf{u},\\
\langle \ell\,,\left(\textbf{v},q\right) \rangle &= \int_{\Omega}\textbf{f}\cdot \textbf{v}
\end{aligned}
\end{equation}
In order to show that, our variational formulation for the Stokes problem admits a unique solution  we include another result from \cite{verfurth2013posteriori}.

\begin{proposition}{$\textbf{inf-sup condition for saddle-point formulation}$} (See \cite{verfurth2013posteriori}: \S 4.10: Proposition 4.69 for a proof)\label{prop_well_pos_verf_saddle}
	The bilinear form $B$ in (\ref{verf_eqns}) satisfies
	\begin{equation}\small
	\inf_{\left(\textbf{w},r\right)\in X\setminus \lbrace0\rbrace}\sup_{\left(\textbf{v},q\right) \in X\setminus \lbrace0\rbrace}\frac{B\left(\left(\textbf{v},q\right),\left(\textbf{w},r\right)\right)>0}{\left|\left|\left(\textbf{v},q\right)\right|\right|_X\left|\left|\left(\textbf{w},r\right)\right|\right|_X}=
	\inf_{\left(\textbf{v},q\right) \in X\setminus \lbrace 0\rbrace}\sup_{\left(\textbf{w},r\right)\in X\setminus \lbrace0\rbrace}\frac{B\left(\left(\textbf{v},q\right),\left(\textbf{w},r\right)\right)>0}{\left|\left|\left(\textbf{v},q\right)\right|\right|_X\left|\left|\left(\textbf{w},r\right)\right|\right|_X}\geq \frac{\beta^2}{1+\beta^2},
	\end{equation}
	where $\beta$ is the same constant as in (\ref{coerc_b}).
\end{proposition}
The results in Proposition \ref{prop_well_pos_verf_saddle} imply that the bilinear form $B$ satisfies the conditions of Proposition \ref{prop_well_pos_verf}.  Hence, our problem is well posed.
\subsection{Finite Element approximation}
In this section we present the finite element approximation to our saddle-point formulation of the Stokes Problem (see (\ref{verf_eqns})).  Firstly we introduce the notation for the spaces we will be searching in for our approximate solutions:
\begin{eqnarray}
	\mathbb{V}_T&\subset&\textbf{H}^1_0\left(\Omega\right)^d,\\
	P_T&\subset& L^2_0\left(\Omega\right).
\end{eqnarray}
Our approximate version of the forms and norm in (\ref{verf_eqns}) are then as follows:
\begin{equation}\label{verf_eqns_approx}
\begin{aligned}
X_T=Y_T&=\mathbb{V}_T\times P_T,\\
B\left(\left(\textbf{u}_T,p_T\right),\left(\textbf{v}_T,q_T\right)\right)&=\int_{\Omega}\nabla \textbf{u}_T : \nabla \textbf{v}_T - \int_{\Omega} p_T \nabla\cdot\textbf{v}_T + \int_{\Omega} q_T \nabla\cdot\textbf{u}_T,\\
\langle \ell_T\,,\left(\textbf{v}_T,q_T\right) \rangle &= \int_{\Omega}\textbf{f}\cdot \textbf{v}_T.
\end{aligned}
\end{equation}
The subscript $T$ indicates the triangulation of $\Omega$ that we are considering.
Our approximate method will be stable if it satisfies the discrete version of (\ref{coerc_b}).  Namely, there exists a constant $\widetilde{\beta}>0$ such that
\begin{equation}\label{verf_inf_sup}
	\inf_{q_T\in \mathbb{P}_T\setminus \lbrace 0 \rbrace}\sup_{\textbf{v}_T\in \mathbb{V}_T\setminus \lbrace 0 \rbrace}\frac{\int_{\Omega}q_T\nabla\cdot\textbf{v}_T}{\left|\textbf{v}_T\right|_1 \left|\left|q\right|\right|_{L^2}}=\widetilde{\beta}>0.
\end{equation}
Analogously, assume that our bilinear form $B$ satisfies the discrete version of (\ref{verf_inf_sup}).  Then our finite element problem also admits a unique solution that depends continuously on the right-hand side \cite{verfurth2013posteriori}.
\subsection{Residual a-posteriori estimates}
Introduction of further terminology.  This information is identical to that presented in \cite{verfurth2013posteriori} \S $4.1$.  Given Banach Spaces $X$ and $Y$ with norms $\left|\left|\cdot\right|\right|_X$ and $\left|\left|\cdot\right|\right|_Y$ respectively we define
\begin{itemize}
\item $\mathcal{L}\left(X,Y\right)$ to be the space of continuous linear mappings from $X$ to $Y$ with norm 
\begin{equation}
\left|\left|L\right|\right|_{\mathcal{L}\left(X,Y\right)} = \sup_{\phi \in X\setminus\lbrace 0\rbrace}\frac{\left|\left|L\phi\right|\right|_Y}{\left|\left|\phi\right|\right|_X}.
\end{equation}
\item $Y^*$ to be the dual space of $Y$ (the space of continuous linear functionals on $Y$).
\item $\langle \cdot,\cdot\rangle_Y$ to be the dual pairing of $Y^*$ and $Y$
\item $\mathcal{L}^2\left(X,Y,\mathbb{R}\right)$ is the space of continuous bi-linear mappings from $X\times Y$ to $\mathbb{R}$ with norm
\begin{equation}
\left|\left|B\right|\right|_{\mathcal{L}^2\left(X,Y,\mathbb{R}\right)} = \sup_{\phi \in X\setminus\lbrace 0\rbrace}\sup_{\psi \in Y\setminus\lbrace 0\rbrace}\frac{\left|B\left(\phi,\psi\right)\right|_Y}{\left|\left|\phi\right|\right|_X\left|\left|\psi\right|\right|_Y}.
\end{equation}
\end{itemize}
 The spaces $\mathcal{L}^2\left(X,Y,\mathbb{R}\right)$ and $\mathcal{L}\left(X,Y^*\right)$ are isomorphic.  The isomorphism is given by 
 \begin{equation}\label{verf_isomorphism}
B\left(\phi,\psi\right)=\langle L\phi,\psi\rangle_Y\quad \forall \phi \in X\text{ and }\forall \psi \in Y,
 \end{equation}
 where $B\in \mathcal{L}^2\left(X,Y,\mathbb{R}\right)$ corresponds to $L\in \mathcal{L}\left(X,Y^*\right)$.  In our case, (\ref{verf_isomorphism}) is actually
 \begin{equation}\label{verf_isomorphism_case}
 B\left(\left(\textbf{v},q\right),\left(\textbf{w},r\right)\right)=\langle L\left(\textbf{v},q\right),\left(\textbf{w},r\right)\rangle_Y\quad \forall \left(\textbf{v},q\right) \in X\text{ and }\forall \left(\textbf{w},r\right) \in Y.
 \end{equation}
 Then,in general, given a $B\in \mathcal{L}^2\left(X,Y,\mathbb{R}\right)$ and $\ell \in Y^*$ the problem is to find $\phi \in X$ such that 
 \begin{equation}
 	B\left(\phi,\psi\right)=\langle\ell,\psi\rangle_Y\quad \forall \psi \in Y.
 \end{equation}
 In our specific case we want to find $\left(\textbf{u},p\right)$ such that 
 \begin{equation}\label{verf_var_case}
 B\left(\left(\textbf{u},p\right),\left(\textbf{v},q\right)\right)=\langle\ell,\left(\textbf{v},q\right)\rangle_Y\quad \forall \left(\textbf{v},q\right) \in Y.
 \end{equation}
 We now make use of the isomorphism (\ref{verf_isomorphism_case}) to write (\ref{verf_var_case}) in the form find  $\left(\textbf{v},q\right)$ such that
 \begin{equation}
  L\left(\textbf{u},p\right)=\ell.
 \end{equation}
\section{Concluding remarks and next steps}\label{sec_conclusion}
In this report we have shown the well-posedness of the Stokes problem and of the adaptive continuous problem.  We have also implemented the Stokes problem in Deal.II in order to acquire some familiarity with this software library.  The next steps will be to carry out the a-posteriori analysis of Stokes and for adaptive Stokes and to implement the latter  in Deal.II.  

%\noindent\begin{minipage}{\textwidth} %
%	\begin{minipage}{0.5\textwidth}
%		\centering
%		\includegraphics[width=.9\linewidth]{p_h_L2.png}
%		\captionof{subfigure}{caption}
%		\label{fig:figure1}
%	\end{minipage}
%	\begin{minipage}{0.5\textwidth}
%		\centering 
%		\includegraphics[width=.9\linewidth]{u_uh_L2.png} 
%		\captionof{subfigure}{caption} 
%		\label{fig:figure2} 
%	\end{minipage}\par
%	\begin{minipage}{0.5\textwidth}
%		\centering
%		\includegraphics[width=.9\linewidth]{u_uh_H1.png}
%		\captionof{subfigure}{caption}
%		\label{fig:figure3}
%	\end{minipage}%
%	\captionof{figure}{figures} 
%	\label{fig:figures} 
%\end{minipage}
\bibliography{biblio_draft}
\bibliographystyle{ieeetr}
\end{document}