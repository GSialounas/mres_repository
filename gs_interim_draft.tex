\documentclass[12pt,a4paper]{article}
\usepackage{listings,chngcntr}
\usepackage{hyperref}% http://ctan.org/pkg/hyperref
\usepackage{paralist}
\usepackage{enumitem}% http://ctan.org/pkg/enumitem
\usepackage{amssymb}
\usepackage{amsmath,amsfonts,bm}
\usepackage{amsthm}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{definition}[theorem]{Definition}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\usepackage{url}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{indentfirst}
\usepackage[percent]{overpic}
\makeatletter
\def\BState{\State\hskip-\ALG@thistlm}
\makeatother
\usepackage{mathtools}
\usepackage{fancyhdr}
\pagestyle{fancy}
\theoremstyle{definition}
\usepackage{float}
\usepackage[utf8]{inputenc}
\usepackage{cleveref}
\crefname{section}{§}{§§}
\Crefname{section}{§}{§§}
\newcommand{\R}{\mathbb{R}}
 \usepackage{stmaryrd}
 \usepackage{graphicx}
 \usepackage{caption}
 \usepackage{subcaption}
 \usepackage[english]{babel}
\usepackage{color}
\newcommand{\hilight}[1]{\colorbox{yellow}{#1}}
\usepackage{soul}

\newcommand\restr[2]{{% we make the whole thing an ordinary symbol
		\left.\kern-\nulldelimiterspace % automatically resize the bar with \right
		#1 % the function
		\vphantom{\big|} % pretend it's a little taller at normal size
		\right|_{#2} % this is the delimiter
}}

\usepackage{listings}
\usepackage{color}
\usepackage{graphicx, epstopdf}
\usepackage{listings}
\lstset{language=Python}
\renewcommand{\sectionautorefname}{\S}
\setlength{\topmargin}{0.0in}
\setlength{\oddsidemargin}{0.33in}
\setlength{\textheight}{9.0in}
\setlength{\textwidth}{6.0in}
\renewcommand{\baselinestretch}{1.25}
%\linespread{1.3}
\setlist[itemize]{noitemsep, topsep=0pt}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\lstset{
	frame=single,
	numbers = left,
	basicstyle=\fontsize{9}{11}\ttfamily\linespread{0.85}\ttfamily,
    breaklines=true
}
\title{Hierarchical Model Adaptivity}
\author{Author: Georgios Sialounas}

\begin{document}
\counterwithin{lstlisting}{section}
\maketitle
\thispagestyle{empty}
\newpage
\tableofcontents
\thispagestyle{empty}
\newpage
\setcounter{page}{1}


\section{Introduction and Motivation}

It is often the case when modelling physical phenomena that we need to solve a complicated system of Partial Differential Equations (PDEs).  This may result in (non-)linear systems which are computationally expensive to solve.  One way to overcome this difficulty is to use some physical reasoning to simplify the model.  The justification is that the simpler model describes the physical system adequately even with the loss of information incurred through the reduction.  

There are many situations where such a reduction may be desirable.  As an example consider oceanic flow, which is governed by the Navier-Stokes equations.  However, if we are interested in the flow away from fixed boundaries, where viscocity is not important, one can accurately describe the flow with  Euler's equations.

The natural problem with this approach are cases in which we actually do need to make use of the complex model in a small part of the domain in order to produce reliable, accurate results.   The mathematical challenge that arises is in the coupling of the simple and complex models so that we retain the savings from using the former in the majority of the domain and the accuracy from using the latter in specific parts of the domain as necessary.

This model refinement can be based on knowledge available $\textit{a priori}$, which informs the decomposition of the domain or on results made available $\textit{a posteriori}$, i.e. during the computation, after each iteration of the algorithm.

The aim of this project will be to develop a strategy to adaptively choose an appropriate model to approximate over specific parts of the domain in real time.  The specific example we will consider is flow governed by Stokes equations, to be reduced to the vectorial Laplacian in parts of the domain where pressure is nearly constant.  The reduction will be based on localised error estimates.  We will examine the errors due to numerical approximation and also due to the model reduction itself.

The rest of the project is structured as follows.  In \S \ref{sec_obj} we present the work we intent to complete by the end of the project.  In \S \ref{sec_mathform} we describe Stokes's equations, introduce their weak form and show that the resulting problem is well-posed.  In \S \ref{sec_adaptivity} we  describe adaptivity and how it will be implemented in this project in greater depth.  In \S \ref{sec_numerics} we present some preliminary results that are produced with the Deal.II software (see \cite{BangerthHartmannKanschat2007}), which  will be used for the numerical implementation component of the project.  We conclude the report in \S \ref{sec_conclusion}, where we also discuss the next steps.

\section{Objectives}\label{sec_obj}
The objectives presented in this section pertain to the entirety of the project and not just to the work presented in this work.  They are essentially a breakdown of the work that must be done in order to  Briefly, our aims for the rest of the project are the following:
\begin{itemize}
\item Mathematical analysis of the weak formulation of the Stokes and Laplace problems.
\item A-posteriori error bounds for the Stokes and Laplace problems.
\item Implement the Stokes model in Deal.II.
\item Mathematical analysis of weak formulation of the combined Stokes-Laplace problem
\item Obtain a-posteriori error bounds for the combined Stokes-Laplace problem.
\item Implementation of the combined Stokes-Laplace problem in Deal.II.
\end{itemize}


\section{Background}\label{literature_review}
\subsection{Finite Elements}
In this section we will briefly review what the Finite Element technique is and how it is used to solve PDEs.  We will define the concepts of triangulation/mesh, basis function, define what a finite element is and finally how this technique is used to solve PDEs.  The reader is advised to check \cite{logg2012automated} and \cite{brenner2007mathematical} for a more comprehensive treatment of the material presented in this section.  We are merely summarising the basic points to acquaint readers with the finite element method.   We will be explaining the method in the context of a model problem: Poisson's equation with homogeneous Dirichlet boundary conditions.  Consider the following problem:
\begin{equation}\label{model_poisson}
\begin{aligned}
-\Delta u &= f \quad \text{in}\quad \Omega\\
u &= g \quad \text{on}\quad \partial \Omega
\end{aligned}
\end{equation}
In order for this problem to have a solution we need certain characteristics from our functions $u$ and $f$.  For example, we require that $u\in C^2\left(\Omega\right) ,\,g\in C\left(\overline{\Omega}\right)$ and $f \in C\left(\Omega\right)$.  Furthermore, equality in (\ref{model_poisson}) is to be understood point-wise:  The left and right hand sides of the equations in (\ref{model_poisson}) must agree for all $x \in \Omega$ and on $\partial\Omega$ respectively. These requirements are too strict however:  the map $-\Delta : C^2\left(\mathbb{R}^2\right)\rightarrow C^0\left(\mathbb{R}^2\right)$ is not invertible.  Instead, we look for an alternative formulation of the problem which allows for more relaxed requirements on $u$.  This formulation is called the variational formulation.   In order to obtain this formulation multiply the first equation in (\ref{model_poisson}) by a test function $v$ from some infinite-dimensional function space $V$ (which we will define shortly) and then integrate by parts.  Also assume that $g=0$, since this is also what we will be using throughout this project.  This gives:
\begin{equation}
\int_{\Omega}\nabla u \cdot \nabla v dx =\int_{\Omega}fvdx,
\end{equation}
where we choose our test function, $v$ to vanish on $\partial \Omega$, since we know what value we want our $u$ to be on $\partial \Omega$.  The variational formulation of (\ref{model_poisson}) can now be given as follows.  Find $u\in V$ such that
\begin{equation}\label{model_var_form}
a\left(u,v\right)=F\left(v\right) \quad \forall v \in V,
\end{equation}
where 
\begin{equation}
a\left(u,v\right) = \int_{\Omega}\nabla u \cdot \nabla v dx 
\end{equation} 
and
\begin{equation}
F\left(v\right) = \int_{\Omega}fvdx.
\end{equation}
A careful inspection of the variational formulation will indicate that now the only thing we are asking of our solution $u$ is that it has one square-integrable derivative and that it is zero on the boundary.  This is a weaker requirement than the existence and uniqueness of two derivatives that we were asking for in (\ref{model_poisson}), which is why (\ref{model_var_form}) is also called the weak formulation.  The next step is to discretize our problem.  Since $V$ is an infinite-dimensional space we have no way of practically searching for a solution in it.   Instead, we will restrict our search in a finite-dimensional subspace of $V$, which we shall call $V_h$ and look for an approximation $u_h$ to $u$.  This gives us the Galerkin approximation to (\ref{model_var_form}):

\theoremstyle{definition}
\begin{definition}{$\left(\textbf{Galerkin Approximation}\,\text{of \ref{model_var_form}}\right)$} 
	Given a finite-dimensional subspace $V_h$ of $V$, find  $u_h \in V_h$ such that
	\begin{equation}
a\left(u_h,v_h\right)=F\left(v_h\right) \quad \forall v_h \in V_h.
	\end{equation}
\end{definition}
This problem is more amenable to practical implementation compared to (\ref{model_poisson}) as it is finite-dimensional and can hence be coded on a computer.  We will not discuss questions about the well-posedness of (\ref{model_poisson}) and (\ref{model_var_form}) or why $u_h$ is a good approximation to $u$ (in fact it is the best in some sense).  For such topics the reader is advised to consult \cite{brenner2007mathematical} and \cite{ern2013theory}. Nonetheless, now that we have our approximate problem we can proceed to the next step, which is  to construct our finite-dimensional function space $V_h$.  
The way we do this is to first geometrically decompose our domain into a finite collection of shapes (cells).  The collection of these cells is called a mesh or a triangulation.  We then equip this mesh with piecewise polynomial basis functions.  The geometric decomposition allows us to simulate complicated domains while the polynomial basis functions provide us with a lot of flexibility.  We know how to integrate them, how to enforce continuity from cell to cell (or to allow for discontinuity should the need arise) and they also allow us to approximate different functions on our domain  by expressing them as a weighted sum of our these basis functions.  Let us explain both concepts in a bit more detail.

Cells, the constitutive elements of the mesh, are usually simple geometric shapes.  These could be intevals in $1D$, polygons (frequently triangles or quadrilaterals) in $2D$ and polyhedra in $3D$.  More formally, the definition of mesh/triangulation is as follows (see \cite{ern2013theory}: \S 1.3 Defn 1.49): 
\theoremstyle{definition}
\begin{definition}{$\textbf{Mesh}$} 
A mesh is the decomposition of a domain $\Omega$ into a finite collection of cells $\left \lbrace K_i\right\rbrace$ (polygons, frequently quadrilaterals or triangles)  such that
\begin{enumerate}
\item $ \mathring{K}_i \cap \mathring{K}_j = \emptyset\quad if\quad i\neq j,\quad and$
\item $\cup_i K_i = \overline{\Omega},$
\end{enumerate}
\end{definition}
which loosely means that the cells have non-overlapping interiors.   Let us also define what basis functions are.  Basis functions have the same meaning (and use) one would expect of basis vectors: we use them so that we can construct any other function in our function space.  They are literally our function space's basis.  
\begin{definition}{$\left(\textbf{Nodal Basis}\right)$}\label{defn_nodal_basis}
	Consider a Triangulation $T$ of $\Omega$ with $N$ vertices $\lbrace x_i\rbrace_{i=0}^{N-1}$ the basis function $\phi_i$ associated with the $i$-th degree of freedom satisfies 
	\begin{equation}
	\phi\left(x_j\right) = \delta_{ij},
	\end{equation}
	where $ \delta_{ij}$ is the Kronecker delta.
\end{definition}
Definition \ref{defn_nodal_basis} essentially says that nodal basis functions take a value of $1$ at their associated degree of freedom and $0$ at all others.
At this point we could go through the details of how to go from the PDE problem to a linear algebraic problem (which is what we solve to get $u_h$).  Interested readers are advised to consult \cite{elman2014finite} for details of this procedure.  Instead, we are going to conclude this section by explaining what a finite element is.  The only additional ingredient we need to explain is what a nodal variable is.  Consider a function $p\in V_h$, where $V_h$ is a finite dimensional function space defined on our cell $K$.  Then, a nodal variable could be a function evaluation of $p$ at a node in $K$, or its derivative at that point, or its integral over $K$.  Now we can give the definition of a finite element.
\begin{definition}{$\left(\textbf{Ciarlet's Finite Element}\right)$}\label{defn_finite-element}
	Let
\begin{enumerate}
\item $K\subset \mathbb{R}^n$ be a bounded closed set with nonempty interior and piece-wise smooth boundary (the element domain),
\item $\mathcal{P}$ be a finite-dimensional space of functions on $K$ (the space of shape functions) and
\item $\mathcal{N}=\lbrace N_1,N_2,\cdots,N_k \rbrace$ be a basis for $\mathcal{P}'$ (the set of nodal variables).
\end{enumerate}
Then the triplet $\left(K,\mathcal{P},\mathcal{N}\right)$ is called a finite element.
\end{definition}


\subsection{Model Adaptivity}
iar with (see \cite{ern2013theory}).   

The idea behind mesh adaptivity is simple: use a mesh which features high resolution  where this is needed and low resolution everywhere else so as to reduce computational cost.  Possible reasons for doing this may include the regularity or smoothness of our problem data or our solution.  If for example our solution changes abruptly in certain areas of our domain and barely in others then this would be a good idea.  In such cases we would like high mesh resolution in places requiring high detail and low resolutions everywhere else.  This will decrease our algorithm's computational cost relative to the case when we have high resolution everywhere.  This naturally leads us to the question of how to implement this reduction of computational costs by a clever allocation of resolution in our domain.

The practical implementation question is how to decide whether a cell should be coarsened, refined or remain unchanged in the process of the computation.  This is done by using an a-posteriori error indicator (see e.g. \cite{braess2007finite}).  This is an error bound which depends on the computed solution and the problem data (i.e. information that is available during the computation).  Furthermore, this is a local estimate.  That is it is computed on a cell by cell basis.  Once we have this bound, depending on which side of the bound the error is (i.e. more or less than the acceptable amount),  we decide whether to refine the cell or do nothing (or coarsen).  This leads us on to the topic of model adaptivity.

The central idea in model adaptivity is that there is often a variety of different systems of PDEs that describe the same physical phenomena.  These models differ in complexity depending on how much detail they can describe about the particular phenomenon (e.g. by including more terms).  Unsurprisingly, more complex models are computationally more expensive in general.   In such cases, computational savings can be achieved by using cheaper models in cases where the computed solution with the simpler model would not be much different than what the expensive one would produce.   In fact, it turns out that in a numerical simulation, in a large portion of the domain, it is not unusual that the complex and the simple models produce solutions that do not differ by much.  The difference arises in places where there exists detail which the simple model does not model. The question then becomes: is it possible to use the complex model only where it is necessary and the simple one everywhere else?  Moreover, is it possible to do this in an adaptive fashion?  That is to identify areas which require treatment by the simple/complex model as the calculation proceeds?

It turns out that, similarly to mesh adaptivity, model adaptivity can be impelemented using an a-posteriori error indicator.  More specifically, the a-posteriori indicator can be divided into different parts, corresponding to discritization errors and modelling errors.  In \cite{braack2003posteriori} Braack and Ern propose a systematic way of measuring model errors in the numerical solution of (stationary) partial differential equations.   They do this first for the case where only modelling errors are assumed to occur.  They point out that this is essentially an extension of a-posteriori error control for discretization errors using dual-weighted residuals (see e.g. \cite{becker2001optimal}). They then extend their algorithm to obtain error control for combined modelling and discretization errors.  The result of their efforts was an indicator which allows for local mesh and model refinement.

There are quite a few additional examples of implementations of automatic model adaptivity based on a posteriori error estimation in the literature.  We will name but a few.
  
In \cite{giesselmann2017posteriori} Giesselman and Pryer present an a posteriori error indicator based on Runge-Kutta-discontinuous Galerkin schemes in the context of compressible fluid flows.  Their indicator drives both model and mesh adaptivity.  In this case, the model hierarchy consists of the Navier-Stokes-Fourier equations, which is the complex model sitting on top of the model hierarchy, approximated by Euler's equations.   The Navier Stokes Fourier equations are given by (see (\cite{giesselmann2017posteriori}:  $\S 1: Eq. \left(1.1\right))$)
\begin{equation}\label{eq_NSF}
\partial_t\textbf{u} +\sum_{\alpha}\partial_{x_\alpha}\textbf{f}_{\alpha}\left(\textbf{u}\right) = \sum_{\alpha}\partial_{x_\alpha}  \left(\varepsilon \textbf{g}_{\alpha}\left(\textbf{u},\nabla\textbf{u}\right)\right)\quad \text{on} \quad \mathbb{T}^d \times \left(0,T\right),
\end{equation}
where $\textbf{u}$ is the vector of unknown conserved quantities, $\varepsilon$ is a small parameter, $\textbf{f}_{\alpha}\in C^2\left(U,\mathbb{R}^n\right), \alpha = 1,\cdots,d$ are the components of the advective flux and $\textbf{g}_{\alpha}\in C^2\left(U\times \mathbb{R}^{d\times n},\mathbb{R}^n\right), \alpha = 1,\cdots,d $ are the componenets of a diffusive flux.  $C$ denotes the space of continuous functions. The state space $U$ is an open set, $T$ is some finite time and $\mathbb{T}^d$ denotes the $d-$ dimensional flat torus. The latter set of equations are a good approximation to the former in the case of very little or no viscosity.  The Euler Equations are given by  (see (\cite{giesselmann2017posteriori}:  $\S 1: Eq. \left(1.2\right))$)
\begin{equation}
\partial_t\textbf{u} +\sum_{\alpha}\partial_{x_\alpha}\textbf{f}_{\alpha}\left(\textbf{u}\right) = \quad \text{on} \quad \mathbb{T}^d \times \left(0,T\right),
\end{equation}
which is a good approximation to (\ref{eq_NSF}) when $\varepsilon$ is small.  Something like this might arise naturally in flows away from obstacles, where advection terms dominate viscous terms.  A model like this could have applications in modelling flows that arise in e.g. aerospace engineering and potentially aeroacoustics. 

There are many other areas of application for model adaptivity.  As an example consider reactive flow computations and in particular flame modelling.  In \cite{becker2007mesh}, model adaptivity is implemented in the context of laminar flames where Fick's law serves as a simple model in a model hierarchy which includes multicomponent diffusion models (i.e. diffusion with multiple different gases).    
Another area of application for model adaptivity is in structural mechanics, where there are multiple examples of model hierarchies.  In the area of plate modelling, \cite{bohinc2009model} implement model adaptivity in the form of an automatic choice of a plate model for thin or thick plates.  The choice between the two models is determined by an an element-wise a posteriori indicator based on stresses. 

\section{Mathematical Formulation}\label{sec_mathform}
In this section we present Laplace's equation and Stokes's equations in their weak form.   We will give conditions for well-posedness for these two problems separately and then go through the steps to show that they are indeed well-posed.  This will serve as a step towards showing the well-posedness of the combined problem.  We will begin from Laplace's equation and continue with Stokes's equations.  Throughout this section, the boldface $\textbf{n}$ will be used to indicate vectors.

\subsection{Laplace's equation}
In this section we will present the vectorial Laplace equations with a forcing on the right-hand side and homogeneous Dirichlet boundary conditions.  We will state the problem, present the weak formulation and then show that it is well-posed.
\subsubsection{Problem Statement}
Consider the vectorial Laplace's problem in the unit square domain  $\Omega = \left[0,1\right]^2 \subset \mathbb{R}^2$, with a prescribed right-hand side $\textbf{f}$ and homogeneous Dirichlet boundary conditions on the boundary $\partial \Omega$.  This involves finding the velocity $\textbf{u}$ such that
\begin{equation} \label{poisson_problem_review}
\begin{aligned}
-\Delta\textbf{u}&= \textbf{f}\text{\quad in $\Omega$},\\
\textbf{u}|_{\partial\Omega}&=0 .
\end{aligned}
\end{equation}
\subsubsection{Weak Formulation}
We will be solving our problems using the Finite Element method, so we will cast (\ref{poisson_problem_review}) in variational form.  Before we proceed we will define the gradient of a vector and the component-wise scalar product, both of which will be used in our variational form .
Firstly, the gradient of a vector function, say $\textbf{u}$, is defined as
\begin{equation}
\nabla \textbf{u} = \left(\frac{\partial u_i}{\partial x_j}\right)_{i,j},\nonumber
\end{equation}
where the indices $i$ and $j$ cycle over the components of $\textbf{u}$ and over the independent variables with respect to which we differentiate $u_i$.   The component-wise scalar product, $:$, is defined as
\begin{equation}\label{poisson_review_back_varform}
\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v}=	\sum_{i}\int_{\Omega}\nabla u_i \cdot \nabla v_i.\nonumber
\end{equation}

We will require that our $\textbf{u}$ is continuous and has continuous first derivatives. 
 In other words, that $\textbf{u}\in \textbf{H}^1_0\left(\Omega\right)^2$, where the Sobolev space $\textbf{H}^1_0\left(\Omega\right)^d$ is  the space of $d$-dimensional functions in $L^2\left(\Omega\right)$ which are zero on the boundary and have their first derivatives in $L^2\left(\Omega\right)$:
\begin{equation}
\textbf{u}\in \textbf{H}^1_0\left(\Omega\right)^2 = \left\lbrace \textbf{u}\in L^2\left(\Omega\right)^d \text{ with } \nabla\textbf{u}_{i,j}\in L^2\left(\Omega\right) \text{ and } \textbf{u}|_{\partial\Omega}=\textbf{0}\right\rbrace. \nonumber
\end{equation}
This space's norm is given by 
\begin{equation}
\left|\textbf{v}\right|_{1}=\left|\left|\nabla\textbf{v}\right|\right|_{L^2\left(\Omega\right)}.\nonumber
\end{equation}
 We will also require that our right-hand side function $\textbf{f}$ is square-integrable, i.e. $\textbf{f}\in L^2\left(\Omega\right)^2$.
 
In order to obtain the variational formulation of (\ref{poisson_problem_review}), we multiply the equation by a test function $\textbf{v}\in \textbf{H}^1_0\left(\Omega\right)^2$ and integrate by parts.  This gives us
\begin{equation}
\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v}\;\mathrm{d}x  =\int_{\Omega}\textbf{f}\cdot \textbf{v} \;\mathrm{d}x.
\end{equation}

The next step is to show that (\ref{poisson_review_back_varform}) is well-posed.
\subsubsection{Well-Posedness}
Since we will be talking about well-posedness it will be helpful to define what we mean by it.  We will use the the same definition of well-posedness that \cite{ern2013theory} uses, which is introduced in \cite{hadamard1932probleme}.  Even though we have 'tailored' the well-posedness definition presented in this section to  (\ref{poisson_review_back_varform}), it is worth noting that the definition given in \cite{ern2013theory} is presented in the context of an abstract (general) problem.  However, we will refrain from using the abstract framework until we deal with the a-posteriori analysis of our problems.
\theoremstyle{definition}
\begin{definition}{$\textbf{Well-posedness of (\ref{poisson_review_back_varform})}$} (see \cite{ern2013theory}: Definition 2.1)
	Problem (\ref{poisson_review_back_varform}) is said to be well-posed if it admits one and only one solution and if the following a priori estimate holds:
	\begin{equation}
\exists c >0 \text{ s.t. } \forall \textbf{f} \in L^2\left(\Omega\right)^2, \left|\textbf{u}\right|_{1}\leq \left|\left|\textbf{f}\right|\right|_{L^2}.
	\end{equation}
\end{definition}
This definition essentially says that we have a unique and stable solution.  Before we proceed we will  define two important concepts in terms of proving well-posedness: coercivity and boundedness.
\theoremstyle{definition}
\begin{definition}{$\textbf{Coercivity and boundedness}$} (see \cite{brenner2007mathematical}: Definition 2.5.2)\label{defn_coerc_bound}
	An (abstract) bilinear form $a\left(\cdot,\cdot\right)$ on a normed linear space $H$ is said  to be bounded (or continuous) if $\exists C > 0$ such that
	\begin{equation}
	\left|a\left(u,v\right)\right|\leq C \left|\left|u\right|\right|_H\left|\left|v\right|\right|_H \quad \forall u,v \in H\nonumber
	\end{equation}
	and coercive on $V\subset H$ if $\exists$ $\alpha > 0$ such that
	\begin{equation}
	a\left(v,v\right)\geq \alpha \left|\left|v\right|\right|_H^2\quad \forall v \in V\nonumber.
	\end{equation}
\end{definition}
In the case of (\ref{poisson_review_back_varform}), the bilinear form $a\left(\cdot,\cdot\right)$ is given by 
\begin{equation}
a\left(\textbf{u},\textbf{v}\right)=\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v}\;\mathrm{d}x. \nonumber
\end{equation}
The reader should note that in this context bounded is the same as continuous and coercive is the same as stable.  In the case of (\ref{poisson_review_back_varform}) we get boundedness by applying the triangle inequality, with $C=1$.  We get coercivity by substituting $\textbf{u}=\textbf{v}$.  This gives us equality (in the definition of coercivity) with $\alpha=1$.  Next, we give the main result which is used to show well-posedness for (\ref{poisson_review_back_varform}).  This is the Lax-Milgram theorem.
\begin{theorem}{$\left(\textbf{Lax-Milgram}\right)$}\label{theorem_Lax_Milgram}(See \cite{brenner2007mathematical}: Theorem 2.7.7)
	Given a Hilbert space $\left(\mathbb{V},\left(\cdot,\cdot\right)\right)$, a continuous, coercive bilinear form $a\left(\cdot,\cdot\right)$ and a continuous linear functional $F\in \mathbb{V}^*$, there exists a unique (and stable) $u\in\mathbb{V}$ such that
	\begin{equation}
a\left(u,v\right)=F\left(v\right)\quad\forall v\in \mathbb{V}.
	\end{equation}
\end{theorem}
\begin{proof}
	See \cite{brenner2007mathematical}: Theorem 2.7.7.
\end{proof}
The space $\mathbb{V}^*$ is the space of bounded linear functionals on $\mathbb{V}$.  In (\ref{poisson_review_back_varform}),
\begin{equation}
F\left(\textbf{v}\right)=\int_{\Omega}\textbf{f}\cdot\textbf{v}.
\end{equation}
Linear functionals are just functions $F:\mathbb{V}\rightarrow\mathbb{R}$ that satisfy
\begin{equation}
F\left(\textbf{u}+\alpha\textbf{v}\right)=F\left(\textbf{u}\right)+\alpha F\left(\textbf{v}\right) \quad\forall \textbf{u},\textbf{v}\in\mathbb{V},\,\alpha\in\mathbb{R}.\nonumber
\end{equation}
Now since the bilinear form in (\ref{poisson_review_back_varform}) is continuous and coercive and since the right-hand side is continuous (this can be seen from a simple application of the Cauchy-Schwarz inequality on the right-hand side), (\ref{poisson_review_back_varform}) has a unique and stable solution by the Lax-Milgram theorem.
\subsection{Stokes Equations}
Stokes equations are used to describe very slow viscous flows .  Such flows might include the motion of the fluid very close to a solid boundary or the flow of magma in the Earth's mantle.  

We consider Stokes's equations in a domain $\Omega = \left[0,1\right]^2 \subset \mathbb{R}^2$, which for a prescribed right-hand side $\textbf{f}$ involves finding $\left(\textbf{u},p\right)$ such that:
\begin{equation}\label{stokes_eq}
\begin{aligned}
	-\Delta\textbf{u} + \nabla p &= \textbf{f} \\ 
	\nabla\cdot \textbf{u}&= 0\\ 
\textbf{u}|_{\partial\Omega}&=0 
\end{aligned}
\end{equation}
where boldface indicates vectors.  In (\ref{stokes_eq}), $\textbf{u},\, \textbf{f}$ and $p$ represent the velocity, the forcing and the pressure respectively.  In this case we have used homogeneous Dirichlet (no-slip) boundary conditions. 
\subsection{Weak Formulation}\label{weak-form-stokes}

Let us begin by defining the  function spaces $\mathbb{V}$ (for velocity) and $\mathbb{P}$ (for pressure) we will be working with:
\begin{eqnarray}\label{fspace_V}
\mathbb{V}&=&\textbf{H}^1_0\left(\Omega\right)^2\text{, with norm: } \left|\textbf{v}\right|_{1}=\left|\left|\nabla\textbf{v}\right|\right|_{L^2\left(\Omega\right)}, \\\label{fspace P}
\mathbb{P}&=&L^2_0\left(\Omega\right)=\left\lbrace q\in L^2\left(\Omega\right): \int_\Omega q=0\right\rbrace\text{, with norm: } \left|\left|q\right|\right|_{L^2\left(\Omega\right)}
\end{eqnarray}
 Henceforth, we will adopt the notation $\left|\textbf{u}\right|_1$ and $\left|\left|q\right|\right|_{L^2}$ for the norms pertaining to the function spaces specified in (\ref{fspace_V}) and (\ref{fspace P}).  
We obtain the weak form of (\ref{stokes_eq}) by multiplying the equations with test functions $\textbf{v}\in \mathbb{V}$ and $q\in\mathbb{P}$ and integrating by parts.  This gives us:
\begin{eqnarray}\label{form-a}
a\left(\textbf{u},\textbf{v}\right) + b\left(\textbf{v},p\right) &=& F\left(\textbf{v}\right)\quad \forall 
\textbf{v} \in \mathbb{V} \text{ and} \\ \label{form-b}
b\left(\textbf{u},q\right)&=&0 \quad \quad\quad\forall q \in \mathbb{P},
\end{eqnarray}

where the linear and bilinear forms defined in (\ref{form-a}) are defined as 
\begin{eqnarray}\label{weak-a}
	a\left(\textbf{u},\textbf{v}\right)&=&\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v}, \\\label{weak-b}
	b\left(\textbf{v},q\right) &=& \int_{\Omega}-q\left(\nabla \cdot \textbf{v}\right) \text{ and}\\\label{weak-F}
    F\left(\textbf{v}\right) &=& \int_{\Omega}\textbf{f}\cdot \textbf{v} .
\end{eqnarray}

\subsection{Well Posedness}\label{sec_wellposed}
We will introduce some notation that will be used for the analysis in this section.  We will adopt the same notation as \cite{Chen2016} for ease of cross-checking, as the analysis in this section relies heavily on results presented therein. 
We will also be frequently making use of the symbol
\begin{equation}
	\lesssim \nonumber,
\end{equation}
which we we will define as follows: if $a\lesssim b$ this means $a\leq C\cdot b$, with $C>0$.  Such multiplicative constants arise often in finite-element analysis and they may depend on a number of factors, such as domain geometry, the shape of the finite-element or the size of the mesh.  
\subsubsection{PDE}\label{PDE_cont}
There are four components to proving the well-posedness of (\ref{form-a})-(\ref{form-b}):
	 \begin{eqnarray}\label{coerc_a}
	\inf_{\textbf{u}\in \mathbb{V}}\sup_{\textbf{v}\in \mathbb{V}}\frac{a\left(\textbf{u},\textbf{v}\right)}{\left|\textbf{u}\right|_1 \left|\textbf{v}\right|_1}&=&\alpha>0,\\\label{coerc_b}
			\inf_{q\in \mathbb{P}}\sup_{\textbf{u}\in \mathbb{V}}\frac{b\left(\textbf{u},q\right)}{\left|\textbf{u}\right|_1 \left|\left|q\right|\right|_{L^2}}&=&\beta>0,\\\label{cont_a}
		a\left(\textbf{u},\textbf{v}\right)&\leq& C_a\left|\textbf{u}\right|_1\left|\textbf{v}\right|_1,\, \forall \textbf{u},\textbf{v} \in \mathbb{V}\text{ and}\\\label{cont_b}
		b\left(\textbf{u},q\right)&\leq& C_b\left|\textbf{u}\right|_1\left|\left|q\right|\right|_{L^2},\,\forall \textbf{u} \in \mathbb{V},\, q \in \mathbb{P}.
	\end{eqnarray}
Briefly, (\ref{coerc_a}) and (\ref{coerc_b}) correspond to the stability of the bi-linear forms specified in (\ref{weak-a}) and (\ref{weak-b}) respectively, while (\ref{cont_a}) and (\ref{cont_b}) correspond to their boundedness, in the same order. It is worth noting that (\ref{coerc_a}) is perhaps more widely known as the $\textit{inf-sup}$ condition (see \cite{brenner2007mathematical}: \S 12). 
We will start by showing that conditions (\ref{coerc_b}), (\ref{cont_a}) and (\ref{cont_b}) hold.  Then we will show (\ref{coerc_a}) holds.  Firstly we will introduce a result that implies (\ref{coerc_b}) holds.  The result can be found in \cite{Chen2016} as Lemma 1.4.
\begin{lemma}\label{Lemma_equiv}
	For any $q\in L^2_0\left(\Omega\right), \exists \textbf{v}\in \textbf{H}^1_0\left(\Omega\right)$ such that
	\begin{equation}
		\nabla \cdot \textbf{v}= q \text{ and } \left|\textbf{v}\right|_1 \lesssim \left|\left|q\right|\right|_{L^2}\nonumber.
	\end{equation}
	Consequently, the inf-sup condition, (\ref{coerc_b}), holds.
\end{lemma}
\begin{proof}
	See \cite{Chen2016}: Lemma 1.4
\end{proof}
We will use the statement of Lemma \ref{Lemma_equiv} to show it implies (\ref{coerc_b}).  Consider (\ref{weak-b}).  We choose $\textbf{v}$ so that the result in Lemma (\ref{Lemma_equiv}) holds. We will label this $\textbf{v}$ as $\textbf{v}_q$ to remember the dependence on $q$.   Hence
\begin{eqnarray}
b\left(\textbf{v}_q,q\right) &=& \left|\left|q\right|\right|_{L^2}^2 \quad\text{by Lemma \ref{Lemma_equiv}  and defn of } \nonumber \left|\left|\cdot\right|\right|_{L^2},\\
&\gtrsim& \left|\left|q\right|\right|_{L^2} \left|\textbf{v}_q\right|_1\quad \text{by Lemma \ref{Lemma_equiv}}.\nonumber
\end{eqnarray}
Now, assume that $\left|\textbf{v}_q\right|_1$ is not zero, divide throughout by it and then and take the supremum over $\textbf{v}\in \mathbb{V}$ to get
\begin{equation}
\sup_{\textbf{0}\neq\textbf{v}\in \mathbb{V}}\frac{b\left(\textbf{v},q\right)}{\left|\textbf{v}\right|_1} \gtrsim \left|\left|q\right|\right|_{L^2}.\nonumber
\end{equation}
Now we divide throughout by $\left|\left|q\right|\right|_{L^2}$, which we also assume not to be equal to zero, and take the $\inf$ of that, which we can do since the inequality is required to hold for all $q\in \mathbb{P}$:
\begin{equation}
\inf_{q\in \mathbb{P}}\frac{1}{\left|\left|q\right|\right|_{L^2}}\sup_{\textbf{v}\in \mathbb{V}}\frac{b\left(\textbf{v},q\right)}{\left|\textbf{v}\right|_1} \gtrsim 1 \nonumber.
\end{equation}
Lastly, we move $q$  inside the supremum to obtain the required result in the form shown in (\ref{coerc_b}) $\qedsymbol$ .  

Next, we show that (\ref{coerc_a}) holds.  This is implied by the fact that (\ref{weak-a}) is coercive:
\begin{eqnarray}
		a\left(\textbf{u},\textbf{u}\right)&=&\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{u}\;\mathrm{d}x,\nonumber\\
		&=&\int_{\Omega}\sum_{i}\nabla u_i \cdot \nabla u_i\;\mathrm{d}x\text{ and}\nonumber\\
		&=&\left|\textbf{u}\right|_1^2,\nonumber
\end{eqnarray}
which is the coercivity condition with equality and $\alpha = 1$.  Now we show that  the coercivity of $a\left(\cdot,\cdot\right)$ implies (\ref{coerc_a}.  Since $a\left(\cdot,\cdot\right)$ is coercive, we have that
\begin{equation}
a\left(\textbf{u},\textbf{u}\right)\geq \alpha  \left|\textbf{u}\right|_1^2 \nonumber.
\end{equation}
We divide throughout by $\left|\textbf{u}\right|_1$, which we assume not to be zero. 
\begin{equation}
\frac{a\left(\textbf{u},\textbf{u}\right)}{\left|\textbf{u}\right|_1}\geq \alpha \left|\textbf{u}\right|_1 \nonumber
\end{equation}
 Then we take the supremum on the left-hand side over all $\textbf{v}\in\mathbb{V}$:
 \begin{equation}
 \sup_{\textbf{v}\in \mathbb{V}}\frac{a\left(\textbf{u},\textbf{v}\right)}{\left|\textbf{v}\right|_1}\geq \alpha \left|\textbf{u}\right|_1\nonumber
 \end{equation}
 Since this result hold for any $\textbf{u}\in \mathbb{V}$ then it also holds for the infimum over $\textbf{u}$:
\begin{equation}
\inf_{\textbf{u}\in \mathbb{V}}\sup_{\textbf{v}\in \mathbb{V}}\frac{a\left(\textbf{u},\textbf{v}\right)}{\left|\textbf{v}\right|_1\left|\textbf{u}\right|_1} \geq \alpha>0\nonumber.
\end{equation}
Lastly, (\ref{cont_a}) and (\ref{cont_b}) follow from an application of the Cauchy-Schwarz inequality on the corresponding bilinear forms.
\subsubsection{Discrete form of the $\textit{inf-sup}$ condition}\label{PDE_disc}
In \S \ref{PDE_cont} we consider (\ref{weak-a}) and \ref{weak-b} in the setting of infinite-dimensional function spaces.  In practice we will be dealing with a finite-dimensional version of these.  Hence, we need to show that the discrete, finite-dimensional problem is also well-posed:
\begin{eqnarray}
		a\left(\textbf{u}_h,\textbf{v}\right) + b\left(\textbf{v},p_h\right) &=& F\left(\textbf{v}\right)\quad \forall 
	\textbf{v} \in \mathbb{V}_h \text{ and} \\
	b\left(\textbf{u}_h,q\right)&=&0 \quad \quad\quad\forall q \in\mathbb{P}_h,
\end{eqnarray}
where $\mathbb{V}_h\subset\mathbb{V}$ and $\mathbb{P}_h\subset\mathbb{P}$.  In this case, the discrete version of the $\textit{inf-sup}$ condition, (\ref{coerc_b}), is given by
\begin{equation}\label{coerc_b_disc}
	\inf_{q\in \mathbb{P}_h}\sup_{\textbf{u}\in \mathbb{V}_h}\frac{b\left(\textbf{u},q\right)}{\left|\textbf{u}\right|_1 \left|\left|q\right|\right|_{L^2}}=\beta>0.
\end{equation}
In order to show that (\ref{coerc_b_disc}) holds we will first introduce some results and definitions. Firstly, we define the Fortin operator:
\theoremstyle{definition}
\begin{definition}{Fortin Operator} (\cite{Chen2016}: Definition 2.1)\label{Fortin_defn}
	A linear operator $\Pi_h: \mathbb{V} \rightarrow \mathbb{V}_h$ is called a Fortin Operator if:
	\begin{enumerate}
	\item$b\left(\Pi_h v, q_h\right)=b\left(v, q_h\right)\quad \forall q_h \in \mathbb{P}_h,$
	\item $\left|\left|\Pi_h v\right|\right|_{\mathbb{V}}\leq C\left|\left|v\right|\right|_\mathbb{V}.$
	\end{enumerate}
\end{definition}
\begin{theorem}\label{theorem_inf_sup_disc}
	Assume the continuous inf-sup condition, (\ref{coerc_b}) holds and there exists a Fortin Operator $\Pi_h$, then the discrete inf-sup condition (\ref{coerc_b_disc}) holds.
\end{theorem}
\begin{proof}
	Since the continuous $\textit{inf-sup}$ condition (\ref{coerc_b}) holds then we know from Lemma \ref{Lemma_equiv} that for any $q\in \mathbb{P}_h \subset \mathbb{P}$ $\exists \textbf{v}\in \mathbb{V}$ such that
	\begin{equation}
		b\left(\textbf{v}, q_h\right)\geq \beta \left|\textbf{v}\right|_1\left|\left|q_h\right|\right|_{L^2} \text{ and } \left|\textbf{v}\right|_1 \lesssim \left|\left|q_h\right|\right|_{L^2}. \nonumber
	\end{equation} 
We have assumed that $\exists$ $\Pi_h$ and from item 1 of this definition we can choose $\textbf{v}=\Pi_h \textbf{v}\in \mathbb{V}_h$ such that
\begin{equation}
	b\left(\Pi_h\textbf{v},q_h\right) =b \left(\textbf{v},q_h\right). \nonumber
\end{equation}
Since (\ref{coerc_b}) holds, we have that
\begin{eqnarray}
b \left(\textbf{v},q_h\right)&\geq& \beta \left|\textbf{v}\right|_1\left|\left|q_h\right|\right|_{L^2} \nonumber \\
&\geq& \frac{\beta}{C} \left|\Pi_h\textbf{v}\right|_1\left|\left|q_h\right|\right|_{L^2}\quad \text{from item 2 of Definition \ref{Fortin_defn}}. \nonumber
\end{eqnarray}
Hence, the discrete $\textit{inf-sup}$ condition holds.
\end{proof}
\subsubsection{Stability bounds}\label{sec_stability_bounds}
The last ingredient we need for well-posedness is stability.  In the case of the continuous problem, we use (\ref{coerc_a})-(\ref{cont_b}) to show that a solution to (\ref{stokes_eq}) is stable. Firstly, we let 
\begin{equation}
	\textbf{v}=\textbf{u},\, q =p
\end{equation}
so that (\ref{form-a}) and (\ref{form-b}) respectively become
\begin{eqnarray}\label{nform-a}
\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{u}-\left(\nabla \cdot \textbf{u}\right)p\;\mathrm{d}x  &=&\int_{\Omega}\textbf{f}\cdot \textbf{u} \;\mathrm{d}x
 \text{ and} \\\label{nform-b}
\int_{\Omega}\left(\nabla \cdot \textbf{u}\right)p\;\mathrm{d}x&=& 0.
\end{eqnarray}
We now substitute (\ref{nform-b}) in (\ref{nform-a}) to obtain
\begin{equation}
\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{u}\;\mathrm{d}x  =\int_{\Omega}\textbf{f}\cdot \textbf{u} \;\mathrm{d}x.
\end{equation}
Notice that the left-hand side is equal to $\left|\textbf{u}\right|_1^2$.  We apply the Cauchy-Schwarz inequality to get
\begin{equation}\label{cauchy-a}
\left|\textbf{u}\right|_1^2\leq\left|\left|\textbf{f}\right|\right|_{L^2}\left|\left|\textbf{u}\right|\right|_{L^2}.
\end{equation}
We would now like to bound the right-hand side such that we obtain a bound based on problem data.  We can do this by using Poincar\'e's inequality:
\begin{equation} 
\left|\left|\textbf{u}\right|\right|_{L^2}\leq C_p\left|\textbf{u}\right|_1\text{, } C_p>0
\end{equation}
Interested readers can find further details on this inequality and its applicability  in (e.g.) \cite{brenner2007mathematical}: \S 5.3.  We use this in (\ref{cauchy-a}) to get
\begin{equation}\label{cauchy-b}
\left|\textbf{u}\right|_1^2\leq C_p\left|\left|\textbf{f}\right|\right|_{L^2} \left|\textbf{u}\right|_1.
\end{equation}
Hence we obtain a bound on $\left|\textbf{u}\right|_1$, 
\begin{equation}\label{bound-u-cont}
\left|\textbf{u}\right|_1\leq C_p\left|\left|\textbf{f}\right|\right|_{L^2}.
\end{equation}
We now try to obtain a bound for $\left|\left|p\right|\right|_{L^2}$ in terms of the problem data, $\textbf{f}$.  The $inf-sup$ condition, (\ref{coerc_b}), implies that
\begin{equation}\nonumber
\beta \left|\left|q\right|\right|_{L^2}\leq \sup_{\textbf{v}\in \mathbb{V}, \,\left|\textbf{v}\right|_{L^2}\leq1}  b\left(\textbf{v},q\right)\quad  \forall q \in L^2
\end{equation}
We now choose $q=p$, which gives 
\begin{eqnarray}\nonumber
\beta \left|\left|p\right|\right|_{L^2} &\leq& \sup_{\textbf{v}\in \mathbb{V}, \,\left|\textbf{v}\right|_1\leq1}  b\left(\textbf{v},p\right)\\\nonumber
&=& \sup \left(\int_{\Omega}\textbf{f}\cdot\textbf{v} -\nabla\textbf{u}:\nabla\textbf{v}\right)\\\nonumber
\text{Cauchy-Schwarz: }&\leq& \sup \left(\left|\left|\textbf{f}\right| \right|_{L^2} \left|\left|\textbf{v}\right|\right|_{L^2}+\left|\textbf{u}\right|_1 \left|\textbf{v}\right|_1\right)\\\nonumber
\text{Poincar\'e's: }&=&\sup \left[\left(C_p\left|\left|\textbf{f}\right| \right|_{L^2}+ \left|\textbf{u}\right|_1\right) \left|\textbf{v}\right|_1\right] \\\nonumber
\left|\textbf{v}\right|_1\leq 1\text{:} &\leq&C_p\left|\left|\textbf{f}\right| \right|_{L^2}+ \left|\textbf{u}\right|_1\\\nonumber
\text{Using }\left(\ref{bound-u-cont}\right):&\leq&2C_p\left|\left|\textbf{f}\right| \right|_{L^2}
\end{eqnarray}
Hence, we have also obtained a stability bound on $\left|\left|p\right|\right|_{L^2}$ :
\begin{equation}\label{bound-p-cont}
\left|\left|p\right|\right|_{L^2} \leq \frac{2C_p}{\beta}\left|\left|\textbf{f}\right|\right|_{L^2}.
\end{equation}
Bounds (\ref{bound-u-cont}) and (\ref{bound-p-cont}) show that the solution to (\ref{stokes_eq}) is stable:
\begin{equation}
\left|\textbf{u}\right|_1+\left|\left|p\right|\right|_{L^2} \leq\left( C_p+\frac{2C_p}{\beta}\right)\left|\left|\textbf{f}\right|\right|_{L^2}.
\end{equation}
In conclusion, in this section we have shown that the Stokes problem has a unique, stable solution.
\subsection{Combined Problem}\label{sec_adaptivity}
In this section we present our combined Stokes-Laplace problem.  We present the variational formulation and then we give conditions under which it is well-posed.  We will consider a domain which is divided into sub-domains based on the equations governing the flow in each subdomain.
\subsubsection{Combined Problem}
\begin{equation}
	\begin{aligned}\label{stokes_eq_adapt}
\text{In $\Omega_{1}$: }  -\Delta\textbf{u} + \nabla p &= \textbf{f} \\ 
	\nabla\cdot \textbf{u}&= 0
	\end{aligned}
\end{equation}
\begin{equation}\label{poisson_eq_adapt}
\text{In $\Omega_{2}$: }-\Delta\textbf{u}= \textbf{f}
\end{equation}
with boundary conditions given by
\begin{equation}\label{bc_adapt}
	\textbf{u}= 0 \text{\quad on $\partial \Omega$}.
\end{equation}
The domain is shown in Figure \ref{fig_domain}.  Naturally, we would like to know whether the problem given by (\ref{stokes_eq_adapt})-(\ref{bc_adapt}) has a unique, stable solution.  In order to do this we will first derive the variational form for (\ref{stokes_eq_adapt})-(\ref{bc_adapt}) and then we will repeat some of the procedures from \S \ref{sec_wellposed} to show that our problem is well-posed.
\begin{figure}[H]
	\centering
	\begin{overpic}[width=0.6\textwidth]{domain}
		\centering
		\put (20,30) {\huge$\displaystyle\Omega_{1}$}
		\put (70,30) {\huge$\displaystyle\Omega_{2}$}
		\put (50,30) {\huge$\displaystyle\mathcal{I}$}
		\put (87,52) {\huge$\displaystyle\partial \Omega$}
		\put (54,11) {\huge$\displaystyle \textbf{n}_1$}
		\linethickness{1pt}
		\put(47,10){\color{red}\vector(1,0){10}}
		\put (54,11) {\huge$\displaystyle \textbf{n}_1$}
		\linethickness{1pt}
		\put(99,30){\color{red}\vector(1,0){10}}
		\put (106,31) {\huge$\displaystyle \textbf{n}_2$}
	\end{overpic}
	\caption{Domain for the adaptive problem, with subdomains $\Omega_{1}$ (Stokes equations), $\Omega_{2}$ (Poisson equation)and boundary $\partial \Omega$ with homogeneous Dirichlet boundary conditions. The interface $\mathcal{I}$ separates the part of the domain where we solve each of the two problems.  The unit vectors $\textbf{n}_1$ and $\textbf{n}_2$ are the outward normals to $\Omega_{1}$ and $\Omega_{2}$ respectively.}
	\label{fig_domain}
\end{figure} 
\subsection{Variational Form}
In this section we derive a variational form for (\ref{stokes_eq_adapt})-(\ref{poisson_eq_adapt}).  We begin by testing the first and second equations in  (\ref{stokes_eq_adapt}) with test functions $\textbf{v}\in \mathbb{V}$ and $q\in \mathbb{P}$, where  $\mathbb{V}$ and $\mathbb{P}$ have been defined in (\ref{fspace_V}) and (\ref{fspace P}) respectively. We integrate the resulting equations by parts to obtain:
\begin{equation}\label{weak_stokes_1}
\begin{aligned}
\int_{\Omega_1}\nabla \textbf{u}^{\left(1\right)} : \nabla \textbf{v}-p\left(\nabla \cdot \textbf{v}\right) +\int_{\mathcal{I}} p\textbf{v}\cdot \textbf{n}_1-\textbf{v}\cdot\left(\textbf{n}_1\cdot\nabla\textbf{u}^{\left(1\right)}\right) &=\int_{\Omega_1}\textbf{f}\cdot \textbf{v}  \quad \forall  \textbf{v}\in \mathbb{V}\\
\int_{\Omega_1}q\left(\nabla \cdot \textbf{u}^{\left(1\right)}\right) &= 0\quad \forall q\in \mathbb{P},
\end{aligned}
\end{equation}
for subdomain $\Omega_1$ and
\begin{equation}\label{weak_poisson}
\int_{\Omega_2}\nabla \textbf{u}^{\left(2\right)} : \nabla \textbf{v} - \int_{\mathcal{I}} \textbf{v}\cdot\left(\textbf{n}_2\cdot\nabla\textbf{u}^{\left(2\right)}\right)= \int_{\Omega_2}\textbf{f}\cdot \textbf{v}  \quad \forall  \textbf{v}\in \mathbb{V}
\end{equation}
for $\Omega_2$, where the unit vectors $\textbf{n}_1$ and $\textbf{n}_2$ are the outward normals to $\Omega_{1}$ and $\Omega_{2}$ respectively and $\nabla \textbf{u}^{\left(1\right)}$ and $\nabla \textbf{u}^{\left(2\right)}$ are the flux gradients in the two subdomains. Notice that the boundary integrals are taken over $\mathcal{I}$ and not over $\partial \Omega_{1}$ and $\partial \Omega_{2}$ because $\textbf{v}=\textbf{0}$ on $ \partial \Omega = \partial \Omega_1\cup \Omega_{2}\setminus \mathcal{I}$.   

Before we proceed, we introduce a jump operator, which is simply a notational convenience for expressing the jump of a quantity across an discontinuity.  Consider a (vector) quantity, $\textbf{b}$ in a domain $\Omega$.   Furthermore, suppose that this curve is shared (e.g. as part of a boundary) by two subdomains such that the values of $\textbf{b}$ at either side of $e$ in each subdomain are $\textbf{b}^{\left(1\right)}$ and $\textbf{b}^{\left(2\right)}$. In our example case we may consider $e = \mathcal{I}$, the interface between the two subdomains shown in Figure \ref{fig_domain}.  Then, the jump accross $\mathcal{I}$ is given by:
\begin{equation}
\llbracket \textbf{u} \rrbracket \coloneqq \textbf{n}_1\cdot \textbf{u}^{\left(1\right)}+\textbf{n}_2\cdot  \textbf{u}^{\left(2\right)}.
\end{equation}
The next step is to combine (\ref{weak_stokes_1}) and (\ref{weak_poisson}) into a single variational form over the whole of $\Omega$:
\begin{equation}\label{weak_total}
\begin{aligned}
\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v}-\int_{\Omega_1}p\left(\nabla \cdot \textbf{v}\right) +\int_{\mathcal{I}} p\textbf{v}\cdot \textbf{n}_1-\textbf{v}\cdot\llbracket\nabla\textbf{u}\rrbracket &=\int_{\Omega}\textbf{f}\cdot \textbf{v} \quad \forall  \textbf{v}\in \mathbb{V}\\
\int_{\Omega_1}q\left(\nabla \cdot \textbf{u}\right) &= 0\quad \forall q\in \mathbb{P},
\end{aligned}
\end{equation}
Now we set $\textbf{v}=\textbf{u}$  and $q=p$ in (\ref{weak_total}).  The latter gives $\int_{\Omega_1}p\left(\nabla \cdot \textbf{u}^{\left(1\right)}\right)=0$.  Hence, (\ref{weak_total}) simplifies to:
\begin{equation}\label{reduced_weak_total}
	\left|\textbf{u}\right|_1^2 + \int_{\mathcal{I}}p\textbf{u}\cdot \textbf{n}_1-\textbf{u}\cdot\llbracket \nabla \textbf{u}\rrbracket =\int_{\Omega_1}\textbf{f}\cdot \textbf{u}.
\end{equation}
In order to proceed from this point we require that on $\mathcal{I}$
\begin{equation}
p\textbf{u}\cdot \textbf{n}_1-\textbf{u}\cdot \llbracket \nabla \textbf{u}\rrbracket=0.
\end{equation}
This simplification reduces (\ref{reduced_weak_total}) to 
\begin{equation}
\left|\textbf{u}\right|_1^2 =\int_{\Omega_1}\textbf{f}\cdot \textbf{u}.
\end{equation}
The procedure to obtain the stability bound for this equation is identical to that in \S \ref{sec_stability_bounds}.  This concludes our stability analysis.
\section{Deal.II}\label{sec_numerics}
Deal.II is a C++, open-source, finite element library which we will be using for the implementation of the computational aspects of this project.  As a benchmark we will be solving the following problem:
\begin{eqnarray}
\label{benchmark_u}
	\textbf{u}\left(\textbf{x}\right)&=&\begin{bmatrix}
	200x^2\left(1-x\right)^2y\left(1-y\right)\left(1-2y\right)  \\
	-200y^2\left(1-y\right)^2x\left(1-x\right)\left(1-2x\right)  
	\end{bmatrix} \text{ and}\\\label{benchmark_p}
	p &=& 10\left(x-1/2\right)^3y^2+\left(1-x\right)^3\left(y-1/2\right)^3,
\end{eqnarray}
where $\textbf{x}=\left(x,y\right)^T$.    We will substitute (\ref{benchmark_u}) and (\ref{benchmark_p}) as exact solutions (\ref{stokes_eq})to obtain the forcing $\textbf{f}$.  We will use this benchmark example to test for convergence in our model.
\subsection{Computational results}
We are solving (\ref{stokes_eq}) using Deal.II with an adaptive mesh.  Figure \ref{fig_stokes_sol}  shows the magnitude of $\textbf{u}$ plotted at each of 5 refinement cycles required to solve the problem for $\left(\textbf{u}, p\right)$ given by (\ref{benchmark_u}) and (\ref{benchmark_p}).  The convergence results are listed in Table \ref{tablebenchmark_convergence} and illustrated in Figure \ref{fig_errors}.
\begin{figure}[H]
	\centering
	\includegraphics[width=10cm]{stokes_cg_velocities}
	\caption{The magnitude of $\textbf{u}$ plotted at each refinement cycle to (\ref{stokes_eq}) with $\textbf{u}$ given by (\ref{benchmark_u}).}
	\label{fig_stokes_sol}
\end{figure}
\begin{table}[H]
	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|} \hline
	refinement cycle & cells & dofs & $||p-p_h||_{L^2}$ & $||u-u_h||_{L^2}$ & $||u-u_h||_{H^1}$\\ \hline
0 & 64 & 679 & 5.1016e-02 & 1.0815e-02 & 4.4823e-01\\ \hline
1 & 136 & 1431 & 1.0905e-01 & 9.9175e-03 & 4.1524e-01\\ \hline
2 & 352 & 3635 & 9.7928e-02 & 7.1343e-03 & 2.9415e-01\\ \hline
3 & 856 & 8615 & 2.3689e-02 & 9.6017e-04 & 8.2062e-02\\ \hline
4 & 2128 & 21115 & 1.1988e-02 & 6.2091e-04 & 5.2756e-02\\ \hline
5 & 5128 & 50427 & 2.4096e-03 & 8.6223e-05 & 1.5147e-02\\ \hline
		\end{tabular}
	\caption{Convergence for $\textbf{u}$ and $p$ in different norms.}
	\label{tablebenchmark_convergence}
	\end{center}
\end{table}


\begin{figure}[H]
	\begin{subfigure}[b]{.45\linewidth}
		\includegraphics[width=\linewidth]{u_uh_L2}
		\caption{Velocity in $L^2$: $\left|\left|u-u_h\right|\right|_{L^2}$.}
		\label{fig_uL2}
	\end{subfigure}
	\begin{subfigure}[b]{.45\linewidth}
		\includegraphics[width=\linewidth]{u_uh_H1}
		\caption{Velocity in $H^1$: $\left|\left|u-u_h\right|\right|_{H^1}$.}
		\label{fig_uH1}
	\end{subfigure}
	\centering
	\begin{subfigure}[b]{.45\linewidth}
		\includegraphics[width=\linewidth]{p_h_L2}
		\caption{Pressure $L^2$: $\left|\left|p-p_h\right|\right|_{L^2}$.}
		\label{fig_pL2}
	\end{subfigure}
	\caption{loglog plots of errors }
	\label{fig_errors}
\end{figure}

\section{A-posteriori 2}
\subsection{Upper bound}
Consider a bilinear form $A$ and a linear form $B$,
\begin{eqnarray}
	A&:&\left[\textbf{H}^1_0\right]^d\times\left[\textbf{H}^1_0\right]^d \rightarrow\mathbb{R}\text{ and}\\
B&:&\left[\textbf{H}^1_0\right]^d\times \left[\textbf{L}^2_0\right]\,\,\rightarrow\mathbb{R},
\end{eqnarray}
such that
\begin{eqnarray}
	A\left(\textbf{u},\textbf{v}\right)&\coloneqq& \int_{\Omega}\nabla\textbf{u}:\nabla \textbf{v}\text{ and}\\
	B\left(\textbf{v},q\right)&\coloneqq&-\int_{\Omega}q\,\text{div}\left(\textbf{v}\right).
\end{eqnarray}
The weak form of the Stokes equation is to find $\left(\textbf{u},p\right)\in \left[\textbf{H}^1_0\right]^d  \times \textbf{L}^2_0$ such that
\begin{equation}\label{weak_stokes}
\begin{rcases}
A\left(\textbf{u},\textbf{v}\right)+B\left(\textbf{v},p\right)&=F\left(\textbf{v}\right)\\
B\left(\textbf{u},q\right)&=0
\end{rcases}
\quad\forall \left(\textbf{v},q\right)\in \left[\textbf{H}^1_0\right]^d  \times \textbf{L}^2_0.
\end{equation}
The finite element approximation of this problem is to find $\left(\textbf{u}_h,p_h\right)\in \left[\mathbb{V}_1\right]^d  \times \mathbb{V}_2\eqqcolon\mathbb{W}$ such that
\begin{equation}\label{weak_stokes_approx}
\begin{rcases}
A\left(\textbf{u}_h,\textbf{v}_h\right)+B\left(\textbf{v}_h,p_h\right)&=F\left(\textbf{v}_h\right)\\
B\left(\textbf{u}_h,q_h\right)&=0
\end{rcases}
\quad\forall \left(\textbf{v}_h,q_h\right)\in \mathbb{W}.
\end{equation}
We now want to control the error for the velocity, $\textbf{e}_u$ and for the pressure, $e_p$.   At the moment we will just obtain an upper bound.  Let us begin by defining both the pressure and the velocity error:
\begin{eqnarray}\label{error_velocity}
\textbf{e}_u&=&\textbf{u}-\textbf{u}_h,\\\label{error_pressure}
e_p &=& p-p_h
\end{eqnarray}
In order to control this error we first choose $\textbf{v}=\textbf{v}_h\in\mathbb{V}_1$, $q=q_h\in\mathbb{V}_2$ in (\ref{weak_stokes}) and then we subtract (\ref{weak_stokes_approx}) from (\ref{weak_stokes}) to obtain
\begin{equation}\label{weak_stokes_approx_galerkin}
	\begin{rcases}
	A\left(\textbf{u}-\textbf{u}_h,\textbf{v}_h\right)+B\left(\textbf{v}_h,p-p_h\right)&=\textbf{0}\\
	B\left(\textbf{u}-\textbf{u}_h,q_h\right)&=0
	\end{rcases}\quad\forall \left(\textbf{v}_h,q_h\right)\in \mathbb{W}.
\end{equation}
This is just a way of saying that the error obeys Galerkin orthogonality.  We now want to change (\ref{weak_stokes_approx_galerkin}) to a form which is convenient in helping us establish a bound for the error.  We do this by manipulating the bilinear form $A$ and the linear form $B$:
\begin{equation}\small \label{weak_stokes_approx_error}
\begin{rcases}
A\left(\textbf{u}-\textbf{u}_h,\textbf{v}\right)+B\left(\textbf{v},p-p_h\right)&=A\left(\textbf{u}-\textbf{u}_h,\textbf{v}-\textbf{v}_h\right)+B\left(\textbf{v}-\textbf{v}_h,p-p_h\right)\\
B\left(\textbf{u}-\textbf{u}_h,q\right)&=B\left(\textbf{u}-\textbf{u}_h,q-q_h\right).
\end{rcases}\quad\forall \left(\textbf{v}_h,q_h\right)\in \mathbb{W}.
\end{equation}
In order to proceed we choose $\textbf{v}=\textbf{u}-\textbf{u}_h$ and $q=p-p_h$ in (\ref{weak_stokes_approx_error}).  This gives:
\begin{equation} \label{weak_stokes_error_bilinforms}
\begin{aligned}
\left|\textbf{u}-\textbf{u}_h\right|^2_1 &=A\left(\textbf{u}-\textbf{u}_h,\textbf{u}-\textbf{u}_h\right)-A\left(\textbf{u}-\textbf{u}_h,\textbf{v}_h\right)\\
														  &+B\left(\textbf{u}-\textbf{u}_h,p-p_h\right)-B\left(\textbf{v}_h,p-p_h\right)\\
														  &+B\left(\textbf{u}-\textbf{u}_h,p-p_h\right)-B\left(\textbf{u}-\textbf{u}_h,q_h\right)
\end{aligned}
\end{equation}
Now we make use of the error definitions (\ref{error_velocity}) and (\ref{error_pressure}) in (\ref{weak_stokes_error_bilinforms}) for convenience in the analysis that will follow:
\begin{equation} \label{weak_stokes_error_bilinforms_euep}
\begin{aligned}
\left|\textbf{e}_u\right|^2_1 &=A\left(\textbf{e}_u,\textbf{e}_u\right)-A\left(\textbf{e}_u,\textbf{v}_h\right)\\
&+B\left(\textbf{e}_u,e_p\right)-B\left(\textbf{v}_h,e_p\right)\\
&+B\left(\textbf{e}_u,e_p\right)-B\left(\textbf{e}_u,q_h\right).
\end{aligned}
\end{equation}
Let $\mathcal{I}_{\mathbb{V}_1}\textbf{e}_u$ and $\mathcal{I}_{\mathbb{V}_2}e_p$ be the approximations of $\textbf{e}_u$ and $e_p$  respectively in their associated finite element subspace.  Now let $\textbf{v}_h= \mathcal{I}_{\mathbb{V}_1}\textbf{e}_u$  and $q_h=\mathcal{I}_{\mathbb{V}_2}e_p$ in (\ref{weak_stokes_error_bilinforms_euep}) (and dropping the subspace subscripts from $\mathcal{I}_{\mathbb{V}_{\left(\cdot\right)}}$) to get 
\begin{equation} \label{weak_stokes_error_bilinforms_euIeu}
\begin{aligned}
\left|\textbf{e}_u\right|^2_1 &=A\left(\textbf{e}_u,\textbf{e}_u-\mathcal{I}\textbf{e}_u\right)\\
&+B\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u,e_p\right)\\
&+B\left(\textbf{e}_u,e_p-\mathcal{I}e_p\right).
\end{aligned}
\end{equation}
We will begin by trying to bound the first two terms in the R.H.S. of (\ref{weak_stokes_error_bilinforms_euIeu}).  Let $\mathcal{T}$ be the triangulation for our domain and let $K$ be an element in the domain. Then
\begin{equation} \small \label{weak_stokes_error_firsttwo}
\begin{aligned}
A\left(\textbf{e}_u,\textbf{e}_u-\mathcal{I}\textbf{e}_u\right)
+B\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u,e_p\right)&= \sum_{K\in\mathcal{T}}\int_{K}\nabla\textbf{e}_u\colon\nabla\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u\right)- e_p\nabla\cdot\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u\right).
\end{aligned}
\end{equation}
Also note that
\begin{equation} \small
\begin{aligned}
A\left(\textbf{u},\textbf{e}_u-\mathcal{I}\textbf{e}_u\right)
+B\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u,p\right)&= \sum_{K\in\mathcal{T}}\int_{K}\textbf{f}\cdot\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u\right).
\end{aligned}
\end{equation}
With this in mind, we can express (\ref{weak_stokes_error_firsttwo}) (after integrating by parts) as
\begin{equation}
\begin{aligned}
\sum_{K\in\mathcal{T}}\int_{K}\left(\textbf{f}+\Delta \textbf{u}_h-\nabla p_h\right)\cdot\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u\right)+&\int_{\partial K}\left[\left(p\textbf{I}-\nabla\textbf{u}\right)\left(\textbf{e}_u-\mathcal{I}\textbf{e}_u\right)\right]\cdot\textbf{n}.
\end{aligned}
\end{equation}
We use this to obtain an upper bound on the terms on the r.h.s. of (\ref{weak_stokes_error_firsttwo}):
\begin{equation}\label{weak_stokes_firstuppbound}\small
\begin{aligned}
\text{(\ref{weak_stokes_error_firsttwo})}\leq\sum_{K\in\mathcal{T}}\left|\left|\textbf{f}+\Delta \textbf{u}_h-\nabla p_h\right|\right|_{L^2}\left|\left|\textbf{e}_u-\mathcal{I}\textbf{e}_u\right|\right|_{L^2} +\sum_{\gamma\in \partial \mathcal{P}}\left|\left|p\textbf{I}-\nabla\textbf{u}\right|\right|_{L^2\left(\gamma\right)}\left|\left|\textbf{e}_u-\mathcal{I}\textbf{e}_u\right|\right|_{L^2\left(\gamma\right)}.
\end{aligned}
\end{equation}
It is now worth introducing some theorems and notions that will help us obtain computable bounds from (\ref{weak_stokes_firstuppbound}).  We will firstly introduce the concept of a regular partition of our domain, $\Omega$.
\begin{definition}{$\textbf{Regular Partition of } \bm{\Omega}$ (see \cite{ainsworth2011posteriori}: \S1.3.3)}
	Let $\Omega$ be a polygonal domain with boundary $\partial \Omega$.  A finite element partition $\mathcal{P}$ of $\Omega$ is a collection $\left\{K\right\}$ such that:
	\begin{enumerate}
	\item The elements form a partition of the domain, that is, $\overline{\Omega}=\cup_{K\in\mathcal{P}}\overline{K}$.
	\item Each element is a triangle or convex quadrilateral contained in $\Omega$.
	\item Any nonempty intersection of (the closure) of each distinct pair of elements is either a single common vertex or a single common edge of both elements.
	\end{enumerate}
Denote the diameter of a triangle $K$ by $h_K$ and the diameter of the largest circle that may be inscribed in the triangle by $\rho_K$.  The regularity of the triangle is measured by the ratio
\begin{equation}
\kappa_K=h_K/\rho_K.\nonumber
\end{equation}
A partition of $\Omega$ is said to be regular if there exists $\kappa\in\mathbb{R}$ such that
\begin{equation}
\max_{K\in\Omega}\kappa_K\leq\kappa.\nonumber
\end{equation}
\end{definition}
Our next step is to introduce the concept of an element patch, $\widetilde{K}$.
\begin{definition}{$\textbf{Patch of elements}$} (See \cite{ainsworth2011posteriori}: \S 1.3.8)
	A patch, $\widetilde{K}$, of elements is defined to be the subdomain of $\Omega$ consisting of the element $K$ along with the elements sharing at least one common vertex with $K$:
	\begin{equation}
		\widetilde{K}=int\left\{\bigcup K', K' \in \mathcal{P}: \overline{K}'\cap\overline{K}\neq \emptyset \right\}.\nonumber
	\end{equation}
\end{definition}
Lastly, we include a theorem from \cite{ainsworth2011posteriori} which will help us obtain bounds on terms of the form $\left|\left|\textbf{e}_u-\mathcal{I}\textbf{e}_u\right|\right|_{L^2\left(\cdot\right)}$ appearing in (\ref{weak_stokes_firstuppbound}).
\begin{theorem}{(see \cite{ainsworth2011posteriori}: Theorem 1.7)}\label{theorem_twobounds}
	Let $r\in\left[1,\infty\right)$, and for a nonnegative $p\in\mathbb{Z}$ let $X$ denote the finite element subspace constructed on a regular partition $\mathcal{P}$ of the polygonal domain $\Omega$ into triangular or quadrilateral elements.  Let $s\in \left[0,1\right]$ and $t$ satisfy $s\leq t\leq p+1$. Then, there exists a bounded, linear operator $\mathcal{I}_X\colon W^{t,r}\left(\Omega\right)\rightarrow X$ and a constant $C\in \mathbb{R}$, which depends only on the regularity $\kappa$ of the partition, such that for all $u\in W^{t,r}\left(\Omega\right)$ and for all $K\in \mathcal{P}$ we have
	\begin{eqnarray}
		\left|u-\mathcal{I}_Xu\right|_{W^{s,r}\left(K\right)} &\leq & Ch_K^{t-s}\left|u\right|_{W^{t,r}\left(\widetilde{K}\right)}\quad\text{and}\nonumber\\
				\left|u-\mathcal{I}_Xu\right|_{W^{s,r}\left(\gamma\right)} &\leq &Ch_K^{t-s-\left(1/r\right)}\left|\left|u\right|\right|_{W^{t,r}\left(\widetilde{K}\right)},\nonumber
	\end{eqnarray}
	where $\gamma$ is any edge of the element $K$ and $\widetilde{K}$ denotes the patch of elements associated with $K$.  We can now use this to obtain bounds on $\left|\textbf{e}_u\right|_1$ in (\ref{weak_stokes_firstuppbound}).
\end{theorem}
Firstly, we choose  $\textbf{u}=\textbf{e}_u$ $r=2$, $s=0$ and $t=1$ in the bounds in Theorem \ref{theorem_twobounds}.  This gives us bounds on $\textbf{e}_u$ over a patch of elements:
\begin{eqnarray}
	\left|\textbf{e}_u-\mathcal{I}_X\textbf{e}_u\right|_{L^2\left(K\right)} &\leq & C_1h_K\left|\textbf{e}_u\right|_{H^1\left(\widetilde{K}\right)}\quad\text{and}\\
	\left|\textbf{e}_u-\mathcal{I}_X\textbf{e}_u\right|_{L^2\left(\gamma\right)} &\leq &C_2h_K^{0.5}\left|\left|\textbf{e}_u\right|\right|_{H^1\left(\widetilde{K}\right)}.
\end{eqnarray}
We substitute these bounds in (\ref{weak_stokes_firstuppbound}) to obtain
\begin{equation}\small
\begin{aligned}
\text{(\ref{weak_stokes_firstuppbound})}&\leq C\left|\left|\textbf{e}_u\right|\right|_{H^1\left(\Omega\right)}\left\{\sum_{K\in\mathcal{T}}h_K^2\left|\left|\textbf{f}+\Delta \textbf{u}_h-\nabla p_h\right|\right|^2_{L^2\left(K\right)} +\sum_{\gamma\in \partial \mathcal{P}}h_K\left|\left|\left[p\textbf{I}-\nabla\textbf{u}\right]\right|\right|_{L^2\left(\gamma\right)}^2\right\}^{1/2}
\end{aligned}
\end{equation}
We regroup this terms to obtain a bound which is summable over the elements:


\section{A-posteriori Verf{\"u}rth}
In this section we present an alternative a-posteriori analysis for the Stokes problem.  This approach is presented in \cite{verfurth2013posteriori} and there are some differences between it and what we did so far.  In order to present the analysis in this section clearly and in an ordered, transparent manner we will follow the same strategy as \cite{verfurth2013posteriori}. Namely,  we will first present results and notation which apply to an abstract variational problem.  These results will be useful in obtaining upper and lower a-posteriori bounds.  After presenting the general results, we will tailor them to the variational formulation of the Stokes problem, which is what interests us. 

\hl{Note to Tristan and Oliver:  I will make a section to explain dual spaces, dual norms and any other concepts I didn't explain properly throughout the text}
\subsection{Abstract Problems-Framework}\label{sec_abst_var_prob}
\subsubsection{Abstract Variational Problem}\label{subsec_verf_abst_var_prob}
This information is identical to that presented in \cite{verfurth2013posteriori} \S $4.1$.  Given Banach Spaces $X$ and $Y$ with norms $\left|\left|\cdot\right|\right|_X$ and $\left|\left|\cdot\right|\right|_Y$ respectively we define
\begin{itemize}
	\item $\mathcal{L}\left(X,Y\right)$ to be the space of continuous linear mappings from $X$ to $Y$ with norm 
	\begin{equation}
	\left|\left|L\right|\right|_{\mathcal{L}\left(X,Y\right)} = \sup_{\phi \in X\setminus\lbrace 0\rbrace}\frac{\left|\left|L\phi\right|\right|_Y}{\left|\left|\phi\right|\right|_X}.
	\end{equation}
	\item $Y^*$ to be the dual space of $Y$ (the space of continuous linear functionals on $Y$).
	\item $\langle \cdot,\cdot\rangle_Y$ to be the dual pairing of $Y^*$ and $Y$
	\item $\mathcal{L}^2\left(X,Y,\mathbb{R}\right)$ is the space of continuous bi-linear mappings from $X\times Y$ to $\mathbb{R}$ with norm
	\begin{equation}
	\left|\left|B\right|\right|_{\mathcal{L}^2\left(X,Y,\mathbb{R}\right)} = \sup_{\phi \in X\setminus\lbrace 0\rbrace}\sup_{\psi \in Y\setminus\lbrace 0\rbrace}\frac{\left|B\left(\phi,\psi\right)\right|_Y}{\left|\left|\phi\right|\right|_X\left|\left|\psi\right|\right|_Y}.
	\end{equation}
\end{itemize}
The spaces $\mathcal{L}^2\left(X,Y,\mathbb{R}\right)$ and $\mathcal{L}\left(X,Y^*\right)$ are isomorphic.  The isomorphism is given by 
\begin{equation}\label{verf_isomorphism}
B\left(\phi,\psi\right)=\langle L\phi,\psi\rangle_Y\quad \forall \phi \in X\text{ and }\forall \psi \in Y,
\end{equation}
where $B\in \mathcal{L}^2\left(X,Y,\mathbb{R}\right)$ corresponds to $L\in \mathcal{L}\left(X,Y^*\right)$.  Now that we have all of our notation in place, this is a good point to introduce the sort of problem we are interested in.  This is done in a general, abstract sense here.  We will tailor it to Stokes later on.

In general, given a $B\in \mathcal{L}^2\left(X,Y,\mathbb{R}\right)$ and $\ell \in Y^*$ the problem is to find $\phi \in X$ such that 
\begin{equation}\label{verf_eqn_var}
B\left(\phi,\psi\right)=\langle\ell,\psi\rangle_Y\quad \forall \psi \in Y.
\end{equation}
Equivalently we can use the isomorphism (\ref{verf_isomorphism}) to express (\ref{verf_eqn_var}) as
\begin{equation}\label{verf_eqn_var_equiv}
L\phi=\ell.
\end{equation}
The reasons we are doing this are related to the analysis required to obtain a-posteriori bounds and will be explained in the sections that follow.  However, before proceeding with any sort of error analysis, we would like to know whether our problem is well-posed.   Recall that we have already presented the conditions for the well-posedness of (\ref{verf_eqn_var})-(\ref{verf_eqn_var_equiv}) in the case of Stokes in \S \ref{PDE_cont} as conditions (\ref{coerc_a})-(\ref{coerc_b}).

We now present conditions for the well-posedness of this problem which are a bit more general and fit into the framework we are using in this section.  
\begin{proposition}{$\textbf{Well-posedness of (\ref{verf_eqn_var})}$} (See \cite{verfurth2013posteriori}: \S 4.1.1: Proposition 4.1)\label{prop_well_pos_verf}
Assume that the space Y is reflexive, that
\begin{equation}
	\sup_{\phi \in X}B\left(\phi,\psi\right)>0
\end{equation}
holds for all $\psi\in Y\setminus \lbrace 0 \rbrace$ and that
\begin{equation}
	\inf_{\phi\in X\setminus \lbrace0\rbrace}\sup_{\psi \in Y\setminus \lbrace0\rbrace}\frac{B\left(\phi,\psi\right)}{\left|\left|\phi\right|\right|_X\left|\left|\psi\right|\right|_Y}=\beta > 0.
\end{equation}
Then (\ref{verf_eqn_var}) admits a unique solution for every right-hand side $\ell\in Y^*$ - where $Y^*$ is the dual of $Y$- and the solution depends continuously on the right-hand side.
\end{proposition}
One may (rightly) wonder why we would go to the trouble of reformulating the conditions that we introduced in \S \ref{PDE_cont}.  Once, again, the reason is because this helps in the analysis that follows.  Observe that the reformulation allows for both the bilinear form $\textbf{a}\left(\cdot,\cdot\right)$ and the linear form $\textbf{b}\left(\cdot\right)$ from \S \ref{PDE_cont} to be incorporated in the bilinear form $B\left(\cdot,\cdot\right)$ in (\ref{verf_eqn_var}).  This will make it easy to use a single norm for the tuple space of the velocities and pressures we will be using for our Stokes problem.  Hence, the analysis required to obtain bounds will be a bit less involved. 
\subsubsection{Abstract Discrete Problem}
The natural next step is to discretize our variational problem (\ref{verf_eqn_var}).  This entails introducing finite dimensional spaces for our solutions and stating conditions analogous to those in Proposition \ref{prop_well_pos_verf} that ensure the well-posedness of the discrete problem.  

Firstly, we choose finite-dimensional subspaces $X_T$ and $Y_T$ of of our finite element spaces $X$ nad $Y$.  Then, the discrete version of (\ref{verf_eqn_var}) is to find $\phi_T\in X_T$ so that
\begin{equation}\label{verf_eqn_disc}
B\left(\phi_T,\psi_T\right)=\langle\ell_T,\psi_T\rangle_{Y_T}\quad \forall \psi_T \in Y_T,
\end{equation}
where in analogy to Proposition \ref{prop_well_pos_verf}, $B_T\in \mathcal{L}^2\left(X_T,Y_T,\mathbb{R}\right)$ and $\ell_T\in Y^*_T$.  Then, just as (\ref{verf_eqn_var}) is equivalent to (\ref{verf_eqn_var_equiv}) via the isomorphism (\ref{verf_isomorphism}), we can use the same isomorphism to write (\ref{verf_eqn_disc}) as 
\begin{equation}\label{verf_eqn_var_equiv_disc}
L_T\phi_T=\ell_T,
\end{equation}
where $L_T\in\mathcal{L}\left(X_T,Y_T^*\right)$ is the linear map that corresponds to $B_T$ via (\ref{verf_isomorphism}).   The conditions for the well-posedness of (\ref{verf_eqn_disc}), which correspond to Proposition \ref{prop_well_pos_verf}, can be summarised as Proposition \ref{prop_well_pos_verf_disc}.
\begin{proposition}{$\textbf{Well-posedness of (\ref{verf_eqn_disc})}$} (See \cite{verfurth2013posteriori}: \S 4.1.3: Proposition 4.5)\label{prop_well_pos_verf_disc}
	Assume that 
	\begin{equation}
	\sup_{\phi_T \in X_T}B_T\left(\phi_T,\psi_T\right)>0
	\end{equation}
	holds for all $\psi_T\in Y_T\setminus \lbrace 0 \rbrace$ and that
	\begin{equation}
	\inf_{\phi_T\in X_T\setminus \lbrace0\rbrace}\sup_{\psi_T \in Y_T\setminus \lbrace 0\rbrace}\frac{B_T\left(\phi_T,\psi_T\right)>0}{\left|\left|\phi_T\right|\right|_{X_T}\left|\left|\psi_T\right|\right|_{Y_T}}=\beta_T > 0.
	\end{equation}
	Then (\ref{verf_eqn_disc}) admits a unique solution for every right-hand side $\ell_T\in Y^*_T$.
\end{proposition}
Next, we tailor the results we presented in this section to the specific case of the Stokes problem.
\subsection{Stokes Problem}
In this section we will present the formulation of our Stokes problem as a variational problem.  We will use the same format as in \S \ref{sec_abst_var_prob}.  Firstly we will introduce the infinite-dimensional problem and the conditions for well-posedness and then we will do the same for its discrete version.  
\subsubsection{Stokes Problem Variational formulation}
In this section we present a variational formulation of the Stokes problem.  The first step will be to introduce the framework we will work with in addressing the problem using the material in the propositions in the last few sections.  The first step is to specify includes the spaces, the norms and the forms we will use.
\begin{equation}\label{verf_eqns}
\begin{aligned}
X=Y&=\left[\textbf{H}^1_0\left(\Omega\right)\right]^d\times L^2_0\left(\Omega\right),\\
\left|\left|\left(\textbf{u},p\right)\right|\right|_X&=\left\lbrace \left|\left|\nabla\textbf{u}\right|\right|^2 + \left|\left|p\right|\right|^2\right\rbrace^{1/2},\\
B\left(\left(\textbf{u},p\right),\left(\textbf{v},q\right)\right)&=\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v} - \int_{\Omega} p \nabla\cdot\textbf{v} + \int_{\Omega} q \nabla\cdot\textbf{u},\\
\langle \ell\,,\left(\textbf{v},q\right) \rangle_Y &= \int_{\Omega}\textbf{f}\cdot \textbf{v}.
\end{aligned}
\end{equation}
In order to show that, our variational formulation for the Stokes problem is well-posed we need another two results from \cite{verfurth2013posteriori}.
\begin{proposition}(See \cite{verfurth2013posteriori} \S 4.10: Proposition 4.67)\label{prop_well_pos_verf_saddle_1}
	The divergence  operator is an isomorphism of 
	\begin{equation}
		V^{\perp} =\lbrace \textbf{v}\in \left[\textbf{H}^1_0\left(\Omega\right)\right]^d: \int_{\Omega}\nabla\textbf{v}:\nabla\textbf{w}=0 \forall \textbf{w}\in V \rbrace\nonumber
	\end{equation}
	onto $L^2_0\left(\Omega\right)$ and
	\begin{equation}\label{verf_infsup_q}
	\inf_{q\in \mathbb{P}\setminus \lbrace 0 \rbrace}\sup_{\textbf{v}\in \mathbb{V}\setminus \lbrace 0 \rbrace}\frac{\int_{\Omega}q\nabla\cdot\textbf{v}}{\left|\textbf{v}\right|_1 \left|\left|q\right|\right|_{L^2}}=\beta>0.\nonumber
	\end{equation}
\end{proposition}
\begin{proposition}{$\textbf{inf-sup condition for saddle-point formulation}$} (See \cite{verfurth2013posteriori} \S 4.10: Proposition 4.69, which also includes a proof)\label{prop_well_pos_verf_saddle}
	The bilinear form $B$ in (\ref{verf_eqns}) satisfies
	\begin{equation}\small
	\begin{aligned}
	\inf_{\left(\textbf{w},r\right)\in X\setminus \lbrace0\rbrace}\sup_{\left(\textbf{v},q\right) \in X\setminus \lbrace0\rbrace}\frac{B\left(\left(\textbf{v},q\right),\left(\textbf{w},r\right)\right)}{\left|\left|\left(\textbf{v},q\right)\right|\right|_X\left|\left|\left(\textbf{w},r\right)\right|\right|_X}=
	\inf_{\left(\textbf{v},q\right) \in X\setminus \lbrace 0\rbrace}\sup_{\left(\textbf{w},r\right)\in X\setminus \lbrace0\rbrace}\frac{B\left(\left(\textbf{v},q\right),\left(\textbf{w},r\right)\right)}{\left|\left|\left(\textbf{v},q\right)\right|\right|_X\left|\left|\left(\textbf{w},r\right)\right|\right|_X}\geq \frac{\beta^2}{1+\beta^2},\nonumber
	\end{aligned}
	\end{equation}
	where $\beta$ is the same constant as in Proposition \ref{prop_well_pos_verf_saddle_1}.
\end{proposition}
A reasonable question to ask at this point is why we need Proposition \ref{prop_well_pos_verf_saddle_1}.  We need it because we use it to prove that Proposition \ref{prop_well_pos_verf_saddle} holds.  In turn, Proposition \ref{prop_well_pos_verf_saddle} implies that the bilinear form $B$ satisfies the conditions of Proposition \ref{prop_well_pos_verf}.  Hence, our variational formulation of the Stokes problem is well-posed.  In order to demonstrate how Proposition \ref{prop_well_pos_verf_saddle_1} contributes towards the proof for the well-posedness of our variational formulation of the Stokes problem, we include the proof that Proposition \ref{prop_well_pos_verf_saddle} holds from \cite{verfurth2013posteriori} (see \S4.10.1: Proposition 4.69).  In the proof that follows note that we emit the result that proves the equality and focus on the inequality.
\begin{proof}
Chose an arbitrary element $\left(\textbf{v},q\right)\in X\setminus \lbrace 0 \rbrace$ and keep it fixed in waht follows.  The definition of B immediately implies that 
\begin{equation}\nonumber
B\left(\left(\textbf{v},q\right),\left(\textbf{v},q\right)\right)= \left|\left|\nabla \textbf{v}\right|\right|^2.
\end{equation}
Due to Proposition \ref{prop_well_pos_verf_saddle_1}, there exists a velocity field $\textbf{w}_q$ with
\begin{equation}\nonumber
\left|\left|\nabla \textbf{w}_q\right|\right|=1 \quad \text{and}\quad \int_{\Omega}q \text{div} \textbf{w}_q \geq \beta \left|\left|q\right|\right|^2.
\end{equation}
Therefore, for every $\delta > 0$
\begin{equation}\nonumber\small
\begin{aligned}\small
B\left(\left(\textbf{v},q\right),\left(\textbf{v}-\delta\left|\left|q\right|\right|\textbf{w}_q,q\right)\right) &= B\left(\left(\textbf{v},q\right),\left(\textbf{v},q\right)\right)-\delta\left|\left|q\right|\right|B\left(\left(\textbf{v},q\right),\left(\textbf{w}_q,0\right)\right)\\
&=\left|\left|\nabla \textbf{v}\right|\right|^2 -  \delta\left|\left|q\right|\right|\int_{\Omega}\nabla\textbf{v}:\nabla\textbf{w}_q +\delta\left|\left|q\right|\right|\left|\left|\nabla \textbf{w}_q\right|\right|\\
&\geq \left|\left|\nabla \textbf{v}\right|\right|^2 -  \delta\left|\left|q\right|\right|\left|\left|\nabla \textbf{v}\right|\right| +\delta \beta \left|\left|q\right|\right|^2\\
&= \left|\left|\nabla \textbf{v}\right|\right|^2 -  \delta\left|\left|q\right|\right|\left|\left|\nabla \textbf{v}\right|\right| +\frac{\delta \beta }{2}\left|\left|q\right|\right|^2\\& + \frac{\delta}{2\beta}\left|\left|\nabla\textbf{v}\right|\right|^2 +\frac{\delta \beta }{2}\left|\left|q\right|\right|^2 - \frac{\delta}{2\beta}\left|\left|\nabla\textbf{v}\right|\right|^2
\end{aligned}
\end{equation}
Now we use the result
\begin{equation}
a^2+b^2\geq 2ab \nonumber
\end{equation}
with \begin{equation}\nonumber
a=\sqrt{\frac{\delta}{2\beta}}\left|\left|\nabla\textbf{v}\right|\right|\text{ and } b = \sqrt{\frac{\delta \beta }{2}}\left|\left|q\right|\right|
\end{equation}
to show that the quantity in the last equality in is greater than
\begin{equation}
\begin{aligned}\nonumber
&\left|\left|\nabla \textbf{v}\right|\right|^2 -  \delta\left|\left|q\right|\right|\left|\left|\nabla \textbf{v}\right|\right| +\frac{\delta \beta }{2}\left|\left|q\right|\right|^2 + \frac{\delta}{2\beta}\left|\left|\nabla\textbf{v}\right|\right|^2 +\frac{\delta \beta }{2}\left|\left|q\right|\right|^2 - \frac{\delta}{2\beta}\left|\left|\nabla\textbf{v}\right|\right|^2\\
&\geq \left|\left|\nabla \textbf{v}\right|\right|^2 -  \delta\left|\left|q\right|\right|\left|\left|\nabla \textbf{v}\right|\right| +\frac{\delta \beta }{2}\left|\left|q\right|\right|^2 + \delta\left|\left|q\right|\right|\left|\left|\nabla \textbf{v}\right|\right|- \frac{\delta}{2\beta}\left|\left|\nabla\textbf{v}\right|\right|^2\\
&=\left(1-\frac{\delta}{2\beta}\right)\left|\left|\nabla \textbf{v}\right|\right|^2 +\frac{\delta\beta}{2}\left|\left|q\right|\right|^2.
\end{aligned}
\end{equation}
We now choose $\delta=\frac{2\beta}{1+\beta^2}$ to obtain
\begin{equation}\nonumber
B\left(\left(\textbf{v},q\right),\left(\textbf{v}-\delta\left|\left|q\right|\right|\textbf{w}_q\right)\right)\geq \frac{\beta^2}{1+\beta^2}\left|\left|\left(\textbf{v},q\right)\right|\right|_X^2.
\end{equation}
On the other hand (using the same value for $\delta$ as above) we have
\begin{equation}
\begin{aligned}\nonumber
\left|\left|\left(\textbf{v}-\delta\left|\left|\textbf{w}_q\right|\right|,q\right)\right|\right|_X&\leq \left|\left|\left(\textbf{v},q\right)\right|\right|_X+\delta\left|\left|q\right|\right|\left|\left|\nabla \textbf{w}_q\right|\right|\\
&=\left|\left|\left(\textbf{v},q\right)\right|\right|_X + \delta\left|\left|q\right|\right|\\
&\leq\left(1+\delta\right)\left|\left|\left(\textbf{v},q\right)\right|\right|_X \\
&=\frac{\left(1+\beta\right)^2}{1+\beta^2}\left|\left|\left(\textbf{v},q\right)\right|\right|_X 
\end{aligned}
\end{equation}
We now combine the two results to obtain
\begin{equation}
\begin{aligned}\nonumber
\sup_{\left(\textbf{w},r\right) \in X\setminus \lbrace0\rbrace}\frac{B\left(\left(\textbf{v},q\right),\left(\textbf{w},r\right)\right)}{\left|\left|\left(\textbf{v},q\right)\right|\right|_X\left|\left|\left(\textbf{w},r\right)\right|\right|_X}&\geq \frac{B\left(\left(\textbf{v},q\right),\left(\textbf{v}-\delta\left|\left|\textbf{w}_q\right|\right|,q\right)\right)}{\left|\left|\left(\textbf{v},q\right)\right|\right|_X\left|\left|\left(\textbf{v}-\delta\left|\left|\textbf{w}_q\right|\right|,q\right)\right|\right|_X}\\
&\geq \frac{\beta^2}{\left(1+\beta\right)^2}.
\end{aligned}
\end{equation}
Recall that $\left(\textbf{v},q\right)$ was chosen arbitrarily.  Hence, we can take the infimum over $\left(\textbf{v},q\right)\in X\setminus\lbrace 0 \rbrace$ on the left hand side to get our result. 
\end{proof}
\subsection{Stokes Problem: FE approximation}
In this section we present the finite element approximation to (\ref{verf_eqns}).  The finite element spaces we are looking will be
\begin{eqnarray}
	\mathbb{V}_T&\subset&\textbf{H}^1_0\left(\Omega\right)^d \text{ and}\nonumber\\
	P_T&\subset& L^2_0\left(\Omega\right),\nonumber
\end{eqnarray}
where $T$ is an appropriate triangulation of our domain $\Omega$.  More specifically, by appropriate we mean affine-equivalent (consists of triangles (and parallelograms)), shape-regular (minmal angle of all elements in $T$ is strictly greater than $0$)  and admissible (the intersection between any two elements in $T$ is at most a vertex or an edge).  The reader can consult \cite{verfurth2013posteriori} or \cite{brenner2007mathematical} for more details.
Our approximate version of the forms and norm in (\ref{verf_eqns}) are then as follows:
\begin{equation}\label{verf_eqns_approx}
\begin{aligned}
X_T=Y_T&=\mathbb{V}_T\times P_T,\\
B\left(\left(\textbf{u}_T,p_T\right),\left(\textbf{v}_T,q_T\right)\right)&=\int_{\Omega}\nabla \textbf{u}_T : \nabla \textbf{v}_T - \int_{\Omega} p_T \nabla\cdot\textbf{v}_T + \int_{\Omega} q_T \nabla\cdot\textbf{u}_T,\\
\langle \ell_T\,,\left(\textbf{v}_T,q_T\right) \rangle &= \int_{\Omega}\textbf{f}\cdot \textbf{v}_T.
\end{aligned}
\end{equation}
Our approximate problem will be well-posed if the discrete version of Propositions \ref{prop_well_pos_verf_saddle_1} and \ref{prop_well_pos_verf_saddle} are satisfied for all triangulations $T$ that we consider.  This is ensured if we choose our finite element spaces for the velocity $V_T$ and the pressure $P_T$ in (\ref{verf_eqns_approx}) appropriately.
There are many such choices (see \cite{verfurth2013posteriori}: \S 4.10.2 for multiple examples) but we will be only use the Taylor-Hood element, which is a well-known, stable choice for the Stokes equation:
\begin{eqnarray}
\begin{aligned}
V_T&=\left[S^{2,0}_0\left(T\right)\right]^d,\\
P_T&=S^{1,0}\left(T\right)\cap L^2_0\left(\Omega\right).
\end{aligned}
\end{eqnarray}
This choice ensures that the forms we introduced in (\ref{verf_eqns_approx}) fulfil the conditions in Propositions \ref{prop_well_pos_verf_saddle_1} and \ref{prop_well_pos_verf_saddle}.  This in turn ensures that the conditions in Proposition \ref{prop_well_pos_verf_disc} are met.  Hence, our discrete problem - i.e. find $\left(\textbf{u}_T, p_T\right)$ such that (\ref{verf_eqns_approx}) holds for all $\left(\textbf{v}_T,q_T\right)\in V_T\times P_T$ - is well-posed.
\subsection{Residual a-posteriori estimates}
In this section we would like to obtain information about what conditions we expect our a-posteriori error indicators to fulfil.  These conditions are summarised by \cite{verfurth2013posteriori} in the form of Theorem \ref{verf_thm_apost_bounds} (see\cite{verfurth2013posteriori}: Theorem 4.7).  Essentially, this result gives us general upper and lower bounds on a-posteriori error indicators, subject to certain conditions.  The content of this section is just a summary of the exposition in \S4.1.4 of \cite{verfurth2013posteriori}, which we follow closely.  

In order to present this result we  will firstly summarise the analysis from \cite{verfurth2013posteriori}, which leads to it.  Later on we will use it to show that our a-posteriori error-indicator for the Stokes problem fulfils the conditions of the theorem and hence bounds the error from above and from below as set forth by Theorem \ref{verf_thm_apost_bounds}.  

Firstly, assume that (\ref{prop_well_pos_verf}) and (\ref{prop_well_pos_verf_disc}) are satisfied.  Hence, our abstract variational problem, (\ref{verf_eqn_var}) and its discretization, (\ref{verf_eqn_disc}) are both well-posed.   We denote by $\phi$ and $\phi_T$ the solutions of (\ref{verf_eqn_var}) and (\ref{verf_eqn_disc}) respectively. We now use the isomorphism,  (\ref{verf_isomorphism}), to get a bound on our error, $\phi-\phi_T$ as follows:
\begin{equation}
L\left(\phi-\phi_T\right)=\ell -L\phi_T
\end{equation}
implies
\begin{equation}\label{verf_infdim_err_bounds}
\left|\left|L\right|\right|^{-1}_{\mathcal{L}\left(X,Y^*\right)}\left|\left|\ell-L\phi_T\right|\right|_{Y^*}\leq \left|\left|\phi-\phi_T\right|\right|_X \leq \left|\left|L^{-1}\right|\right|_{\mathcal{L}\left(Y^*,X\right)}\left|\left|\ell-L\phi_T\right|\right|_{Y^*}.
\end{equation}
Hence, for all $\psi \in Y$ (and letting $\left|\left|\psi\right|\right|_Y=1$) we get 
\begin{equation}
\langle\ell -L\phi_T,\psi \rangle_Y=\langle L\left( \phi-\phi_T\right),\psi \rangle_Y\leq \left|\left|L\right|\right|_{\mathcal{L}\left(X,Y^*\right)}\left|\left|\phi-\phi_T\right|\right|_X
\end{equation}
The problem with the bounds in (\ref{verf_infdim_err_bounds}) is that computing the dual norm of $\ell-L\phi_T$ is as difficult as solving the original problem.  Instead, we need something more practical which can hopefully be computed with reasonable effort during a computation.   As \cite{verfurth2013posteriori} points out, we need to make sure that a few things hold before proceeding from this point. Namely, that $Y$ is a suitable subspace of a suitable $W^{1,2}$ space,
 that our residual $\ell - L\phi_T$ admits an $L^2$ representation and that it also satisfies Galerkin orthogonality.  The first point is taken care of by careful selection of our spaces and subspaces such that our well-posedness conditions are satisfied.  The choice of spaces is usually made obvious by the equation we are dealing with.  
 
 In order to obtain the $L^2$ representation of our residual we use integration by parts.  Lastly, for Galerkin orthogonality, consider the case when the discrete forms $B_T$ and $\ell_T$ are the restrictions of $B$ and $\ell$ respectively to the finite-dimensional spaces.  That is, consider that
 \begin{eqnarray}
B_T\left(\phi_T,\psi_T\right)&=&B\left(\phi_T,\psi_T\right)\text{ and}\\
\langle \ell_T, \psi_T\rangle_{Y_T} &=& \langle \ell_T, \psi_T\rangle_{Y},
 \end{eqnarray}
 holds for all $\phi_T\in X_T$ and for all $\psi_T \in Y_T$.  Then Galerkin orthogonality holds: i.e. using the isomorphism (\ref{verf_isomorphism}),
 \begin{equation}
\langle \ell -L\phi_T,\psi_T\rangle_{Y}=\langle L\left(\phi-\phi_T\right),\psi_T\rangle_{Y}=0.
 \end{equation}
 Now, we want to obtain bounds for the dual norm of the residual $\left|\left|\ell-L\phi_T\right|\right|_{Y^*}$.  We do this by introducing a restriction operator $Q_T:Y\leftarrow Y_T$, which we use to split our residual as follows:
 \begin{equation}\label{verf_residual_split}
 	\ell-L\phi_T=\left(Id_Y-Q_T\right)^*\left(\ell-L\phi_T\right)+Q_T^*\left(\ell-L\phi_T\right).
 \end{equation}
 where $Id_Y$ denotes the identity map in the space $Y$ and $Q_T^*$ is the adjoint of $Q_T$. such that 
 \begin{equation}
\langle \ell -L\phi_T, Q_T\psi_T\rangle_Y = \langle Q_T^*\left(\ell -L\phi_T\right), \psi_T\rangle_Y. 
 \end{equation}  
 At this point, \cite{verfurth2013posteriori} uses (\ref{verf_infdim_err_bounds}) to obtain an upper bound for the error as shown below
 \begin{equation}\small
\left|\left|\phi-\phi_T\right|\right|_X\leq \left|\left|L^{-1}\right|\right|_{\mathcal{L}\left(Y^*,X\right)}\left\lbrace\left|\left| \left(Id_Y-Q_T\right)^*\left(\ell-L\phi_T\right)\right|\right|_{Y^*} +\left|\left| Q_T^*\left(\ell-L\phi_T\right)\right|\right|_{Y^*}\right\rbrace,
 \end{equation}
 noting that, when Galerkin orthogonality is satisfied, the terms involving $Q_T^*$ vanish.  Notice that although this is an upper bound, it still involves dual norms.  It would be more accurate to describe it as part of a condition that we will use to ensure that our a-posteriori error indicator can be used to get an upper bound on the error.
 
  \hl{Note to Tristan and Oliver: I will also explain why we are going to the trouble of choosing the subspace for the lower bound in the analysis that follows, hopefully soon, but as that involves a bit of extra reading I will postpone it until after I get the more essential parts of the analysis done}. Next, we want to get a condition for a lower-bound.  We firstly choose a finite-dimensional subspace $\widetilde{Y}_T$ of $Y$ such that $\widetilde{Y}_T\subset Y_T\subset Y$.  Then, we use the definition of the dual norm 
 together with the fact that $\widetilde{Y}_T\subset Y_T$ to obtain
 \begin{equation}\label{verf_subspace_dual_bound}
\left|\left| \ell-L\phi_T\right|\right|_{\widetilde{Y}^*}\leq \left|\left| \ell-L\phi_T\right|\right|_{Y^*}.
 \end{equation}
 The results in (\ref{verf_infdim_err_bounds}) together with (\ref{verf_subspace_dual_bound}) give us
 \begin{equation}
\left|\left| \ell-L\phi_T\right|\right|_{\widetilde{Y}^*}\leq \left|\left|L\right|\right|_{\mathcal{L}\left(X,Y^*\right)}\left|\left|\phi-\phi_T\right|\right|_X.
 \end{equation}
 Now, assume that we can somehow manage to show that for our problem there exists a finite constant $C$ such that
 \begin{equation}
\left|\left| \left(Id_Y-Q_T\right)^*\left(\ell-L\phi_T\right)\right|\right|_{Y^*} +\left|\left| Q_T^*\left(\ell-L\phi_T\right)\right|\right|_{Y^*}\leq C \left|\left| \ell-L\phi_T\right|\right|_{\widetilde{Y}^*}
 \end{equation}
 holds. Suppose also that we can find an error indicator, $\eta_T$, that depends only on the computed discrete solution, $\phi_T$, and on the problem data $f$ and that we can use $\eta_T$ to bound $\left|\left| \left(Id_Y-Q_T\right)^*\left(\ell-L\phi_T\right)\right|\right|_{Y^*} +\left|\left| Q_T^*\left(\ell-L\phi_T\right)\right|\right|_{Y^*}$ from above and $\left|\left| \ell-L\phi_T\right|\right|_{\widetilde{Y}^*}$ from below.  
 
 
  If we can do this, then, as \cite{verfurth2013posteriori} points out, the a-posteriori error estimation for our problem is equivalent to finding the appropriate $\eta_T$ for our problem.  Note that it is also possible that we will need to include a data error, $\theta_T$, if we also need to approximate the given data.  The conditions that an appropriate a-posteriori indicator must fulfil have been tidied-up and summarised in Theorem \ref{verf_thm_apost_bounds}.
\begin{theorem}{Abstract framework for an a-posteriori error estimator}(See \cite{verfurth2013posteriori} \S4.1.4: Theorem 4.7)\label{verf_thm_apost_bounds}
Assume that the conditions of Propositions \ref{prop_well_pos_verf} and \ref{prop_well_pos_verf_disc} are satisfied and denote by $\phi$ and $\phi_T$ the unique solutions of respectively. Assume that there is a restriction operator $Q_T\in \mathcal{L}\left(Y,Y_T\right)$, a finite dimensional subspace $\widetilde{Y}_T$ of $Y$ such that $Y_T\subset\widetilde{Y}_T\subset Y$, an error indicator $\eta_T$, which only depends on the discrete solution $\phi_T$ and the given data of the variational problem and a data error which depends only on the data of the variational problem such that the estimates
\begin{equation}\nonumber
\begin{aligned}
\left|\left|\left(Id_Y-Q_T\right)^*\left(\ell -L\phi_T\right)\right|\right|_{Y^*}&\leq c_A \left(\eta_T + \theta_T\right),\\
\left|\left|Q_T^*\left(\ell -L\phi_T\right)\right|\right|_{Y^*}&\leq c_C\left(\eta_T+\theta_T\right)\text{ and}\\
\eta_T &\leq c_I\left(\left|\left|\ell - L\phi_T\right|\right|_{\widetilde{Y}^*_T}+ \theta_T\right)
\end{aligned}
\end{equation}
are fulfilled.  Then the error $\phi-\phi_T$ can be bound from above by
\begin{equation}\nonumber
\left|\left|\phi-\phi_T\right|\right|_X\leq\left|\left|L^{-1}\right|\right|_{\mathcal{L}\left(Y^*,X\right)}\left(c_A+c_C\right)\left(\eta_T+\theta_T\right)
\end{equation}
and from below by 
\begin{equation}\nonumber
\eta_T\leq c_I\left(\left|\left|L\right|\right|_{\mathcal{L}\left(X,Y^*\right)}\left|\left|\phi-\phi_T\right|\right|_X+\theta_T\right).
\end{equation}
\end{theorem}
Now we need to show that we can produce an appropriate a-posteriori indicator $\eta_T$ that fulfils the conditions in Theorem \ref{verf_thm_apost_bounds}.  At the same time note that we are considering the data error, $\theta_T$ to be zero at the moment.

We will start by showing that we can come up with an indicator that satisfies the first condition in Theorem \ref{verf_thm_apost_bounds}.  Let $\left(\textbf{u},p\right)\in X$ be the unique solution to (\ref{verf_eqns}) and $\left(\textbf{u}_T,p_T\right)\in X_T$ be the unique solution to (\ref{verf_eqns_approx}).  Now consider a $\left(\textbf{v},q\right)\in X$ and keep it fixed.  Our residual (more accurately an $L^2$-representation of our residual) is given by writing (\ref{verf_eqns_approx}) as a sum over the elements $K\in T$, integrating by parts and subtracting it from the right-hand side of \ref{verf_eqn_var_equiv} (see \cite{verfurth2013posteriori} \S 4.10.3):
\begin{eqnarray}\label{L2-rep-residual}
\langle \ell -L\left(\textbf{u}_T,p_T\right),\left(\textbf{v},q\right) \rangle_Y= &\sum_{K\in T}&\int_{K}\left(\textbf{f}+\Delta \textbf{u}_T-\nabla p_T\right)\cdot \textbf{v}\nonumber\\-&\sum_{E\in \mathcal{E}_{\Omega}}&\int_{E}\llbracket\textbf{n}_E\cdot\left(\nabla \textbf{u}_T-p_T\mathcal{I}\right)\rrbracket \cdot \textbf{v}\\
-&\sum_{K\in T}&\int_{K}q \nabla \cdot \textbf{u}_T, \nonumber
\end{eqnarray}
where the second term on the right-hand side is the sum over the interior edges of the domain.   Before we proceed let us define the restriction operator 
\begin{equation}
\begin{aligned}
&Q_T:X\rightarrow X_T\text{ by}\\
&Q_T\left(\textbf{v},q\right)=\left(\mathcal{I}_T\textbf{v},0\right).
\end{aligned}
\end{equation}
Hence,
\begin{equation}\label{verf-a-posteriori-bound}
\begin{aligned}
\langle \ell -L\left(\textbf{u}_T,p_T\right),\left(Id-Q_T\right)\left(\textbf{v},q\right) \rangle_Y= &\sum_{K\in T}\int_{K}\left(\textbf{f}+\Delta \textbf{u}_T-\nabla p_T\right)\cdot \left(\textbf{v}-\mathcal{I}_T\textbf{v}\right)\\-&\sum_{E\in \mathcal{E}_{\Omega}}\int_{E}\llbracket\nabla \textbf{u}_T-p_TI\rrbracket \cdot \left(\textbf{v}-\mathcal{I}_T\textbf{v}\right)\\
-&\sum_{K\in T}\int_{K}q \nabla \cdot \textbf{u}_T, 
\end{aligned}
\end{equation}
where $Id$ stands for the identity operator from $X$ to $X$.  Now we use the Cauchy-Schwarz inequality on (\ref{verf-a-posteriori-bound}) to get
\begin{equation}\label{verf-a-posteriori-bound-cs}
\begin{aligned}
\langle \ell -L\left(\textbf{u}_T,p_T\right),\left(Id-Q_T\right)\left(\textbf{v},q\right) \rangle_Y\leq
&\sum_{K\in T}\left|\left|\textbf{f}+\Delta \textbf{u}_T-\nabla p_T \right|\right|_K \left|\left|\textbf{v}-\mathcal{I}_T\textbf{v}\right|\right|_K\\
-&\sum_{E\in \mathcal{E}_{\Omega}}\left|\left|\llbracket\nabla \textbf{u}_T-p_TI\rrbracket \right|\right|_E \left|\left|\textbf{v}-\mathcal{I}_T\textbf{v}\right|\right|_E\\
-&\sum_{K\in T}\left|\left|q\right|\right|_K\left|\left|\nabla \cdot \textbf{u}_T\right|\right|_K.
\end{aligned}
\end{equation}
We now introduce some further results from \cite{verfurth2013posteriori} which will help us bound the quantities $\left|\left|\textbf{v}-\mathcal{I}_T\textbf{v}\right|\right|_K$, $\left|\left|\textbf{v}-\mathcal{I}_T\textbf{v}\right|\right|_E$ and $\left|\left|q\right|\right|_K$ in terms of the norm $\left|\left|\left(\cdot,\cdot\right)\right|\right|_X$ introduced in (\ref{verf_eqns}).
\begin{proposition}{(See \cite{verfurth2013posteriori} \S3.5: Proposition 3.33)} \label{verf_prop_bounds} For every Lebesque exponent p, every element $K\in T$and every face $E\in\mathcal{E}_K$ thereof, the local error estimates
\begin{equation}
\begin{aligned}
\left|\left|v-\mathcal{I}_Tv\right|\right|_{p;K}&\leq C_{A,1,p}\left(K\right)\left|\left|v\right|\right|_{p;\widetilde{\omega}_K}\\
\left|\left|v-\mathcal{I}_Tv\right|\right|_{p;K}&\leq C_{A,2,p}\left(K\right)h_K\left|\left|\nabla v\right|\right|_{p;\widetilde{\omega}_K}\\
\left|\left|\nabla\left(v-\mathcal{I}_Tv\right)\right|\right|_{p;K}&\leq C_{A,3,p}\left(K\right)\left|\left|\nabla v\right|\right|_{p;\widetilde{\omega}_K}\\
\left|\left|v-\mathcal{I}_Tv\right|\right|_{p;E}&\leq C_{A,4,p}\left(E\right)h_E^{1-1/p}\left|\left|v\right|\right|_{p;\widetilde{\omega}_E},
\end{aligned}
\end{equation}
where $C_{A,\left(\cdot\right),p}\left(\cdot\right)$ are appropriate constants, hold for all functions $v\in W^{1,p}_D\left(\Omega\right)$ (See \cite{verfurth2013posteriori}: Proposition 3.33 for the constants' values and for a proof of this proposition).
\end{proposition}
We use the results in Proposition \ref{verf_prop_bounds} to bound the right-hand side of (\ref{verf-a-posteriori-bound-cs}):
\begin{equation}\small
\begin{aligned}\small
\langle \ell -L\left(\textbf{u}_T,p_T\right),\left(Id-Q_T\right)\left(\textbf{v},q\right) \rangle_Y\leq
&\sum_{K\in T}\left|\left|\textbf{f}+\Delta \textbf{u}_T-\nabla p_T \right|\right|_K C_{A,2,2}\left(K\right)h_K \left|\left|\nabla\textbf{v}\right|\right|_{2;\widetilde{\omega}_K}\\
-&\sum_{E\in \mathcal{E}_{\Omega}}\left|\left|\llbracket\nabla \textbf{u}_T-p_TI\rrbracket \right|\right|_EC_{A,4,2}\left(K\right)h_E^{1/2} \left|\left|\nabla\textbf{v}\right|\right|_{2;\widetilde{\omega}_E}\\
-&\sum_{K\in T}\left|\left|q\right|\right|_K\left|\left|\nabla \cdot \textbf{u}_T\right|\right|_K\\
\leq &c\max \{C_{A,2,2}\left(K\right),C_{A,4,2}\left(E\right)\}\left|\left|\left(\textbf{v},q\right)\right|\right|_X\times\\ \{\sum_{K\in T}h^2_K\left|\left|\textbf{f}+\Delta \textbf{u}_T-\nabla p_T \right|\right|_K^2+\left|\left|\textbf{u}_T\right|\right|^2_K+&\sum_{E\in \mathcal{E}_{\Omega}}h_E\left|\left|\llbracket\nabla \textbf{u}_T-p_TI\rrbracket \right|\right|_E^2 \}^{1/2},
\end{aligned}
\end{equation}
where $c$ is a constant that depends on the shape parameter of our triangulation, $T$.  Since $\left(\textbf{v},q\right)$ was chosen arbitrarily, we see that the first condition in Theorem \ref{verf_thm_apost_bounds} is satisfied with $\eta_T$ given by  
\begin{equation}\small
\eta_T=\left\lbrace \sum_{K\in T}h^2_K\left|\left|\textbf{f}+\Delta \textbf{u}_T-\nabla p_T \right|\right|_K^2+\left|\left|\text{div }\textbf{u}_T\right|\right|^2_K+\sum_{E\in \mathcal{E}_{\Omega}}h_E\left|\left|\llbracket\nabla \textbf{u}_T-p_TI\rrbracket \right|\right|_E^2  \right\rbrace ^{1/2}
\end{equation}
and $\theta_T$ given by 
\begin{equation}
\theta_T=\left \lbrace \sum_{K\in T}h^2_K\left|\left|\textbf{f}-\textbf{f}_T\right|\right|^2_K \right \rbrace^{1/2}
\end{equation}
The constant $c_A$ depends only on the shape parameter of our triangulation.  Also note that in our case $\theta_T$ will be zero due to the fact we are choosing a piecewise polynomial $\textbf{f}$ which is exactly represented by $\textbf{f}_T$. 
Next, we consider the second condition of Theorem \ref{verf_thm_apost_bounds}.  Firstly, suppose that
\begin{eqnarray}
B_T\left(\left(\textbf{u}_T,p_T\right),\left(\textbf{v}_T,q_T\right)\right)&=&B\left(\left(\textbf{u}_T,p_T\right),\left(\textbf{v}_T,q_T\right)\right)\text{ and that }\\
\langle \ell_T,\psi_T \rangle_{Y_T}&=&\langle \ell,\psi_T \rangle_{Y}.
\end{eqnarray}
In this case, assuming Galerkin orthogonality holds, i.e.
\begin{equation}
B\left(\left(\textbf{u},p\right)-\left(\textbf{u}_T,p_T\right),\left(\textbf{v}_T,q_T\right)\right) = 0
\end{equation} 
This is equivalent to 
\begin{eqnarray}
\langle L\left(\textbf{u},p\right)-L\left(\textbf{u}_T,p_T\right),\left(\textbf{v}_T,q_T\right)\rangle_Y&=&\langle \ell - L\left(\textbf{u}_T,p_T\right),\left(\textbf{v}_T,q_T\right) \rangle_Y\nonumber\\
&=&\langle \ell_T - L_T\left(\textbf{u}_T,p_T\right),\left(\textbf{v}_T,q_T\right) \rangle_{Y_T}\nonumber\\
&=&0.\nonumber
\end{eqnarray}
Hence, the second condition of Theorem \ref{verf_thm_apost_bounds} is also satisfied.  Lastly, we will look at the conditions that give us the lower bound. \hl{Put the proof for the last condition here}.

We summarise the a-posteriori analysis for the Stokes problem by including the relevant result from \cite{verfurth2013posteriori}.
\begin{theorem}{(See \cite{verfurth2013posteriori}: \S4.10.3 Theorem 4.70))}\label{verf_theorem_apost_err_ind}
Denote by $\left(\textbf{u},p\right)$ the unique solution of the saddle-point formulation of the Stokes equations and by $\left(\textbf{u}_T,p_T\right)\in X_T$ its finite element approximation.  For every element $K\in T$ define the residual a-posteriori error indicator $\eta_{R,K}$ by
\begin{equation}\small
\eta_{R,K}=\left(h^2_K\left|\left|\textbf{f}_T+\Delta \textbf{u}_T-\nabla p_T\right|\right|^2_K+\left|\left|\text{div} \textbf{u}_T\right|\right|^2_K+\frac{1}{2}\sum_{E\in\mathcal{E}_{K,\Omega}}h_E\left|\left| \llbracket \nabla \textbf{u}_T -p_T \rrbracket \right|\right|_E^2\right)^{1/2}.\nonumber
\end{equation}
Then, denoting any piecewise polynomial approximation of the problem data, $\textbf{f}$, by $\textbf{f}_T$, there are two constants, $c^*$ and $c$ such that the estimates
\begin{equation}\nonumber
\left(\left|\left|\nabla\left(\textbf{u}-\textbf{u}_T\right)\right|\right|^2+\left|\left|p-p_T\right|\right|^2\right)^{1/2}\leq c^*\left(\sum_{K\in T}\eta^2_{R,K}+\sum_{K\in T}h^2_K\left|\left|\textbf{f}-\textbf{f}_T\right|\right|^2_K\right)^{1/2}
\end{equation}
and
\begin{equation}\nonumber
\eta_{R,K}\leq c \left(\left|\left|\nabla\left(\textbf{u}-\textbf{u}_T\right)\right|\right|_{\omega_K}^2+\left|\left|p-p_T\right|\right|_{\omega_K}^2+\sum_{K'\subset \omega_K}h^2_{K'}\left|\left|\textbf{f}-\textbf{f}_T\right|\right|^2_{K'}\right)^{1/2}
\end{equation}
hold for all $K\in T$.  Both $c^*$ and $c$ depend on the shape parameter $C_T$.  The constant $c$ depends on the polynomial degrees of $\textbf{u}_T$, $p_T$ and $\textbf{f}_T$.  The constant $c^*$ additionally depends on the stabilisation parameters of the finite element approximation through $\max_{K\in T}\widetilde{\theta}_K$.
\end{theorem}


\subsection{A-Posteriori for combined prob.}
In this section we will present the a-posteriori analysis for the mixed problem.  We will firstly summarise the framework for each of the two problem.  Then we will present the framework for the combined problem.   We will use this framework to carry out the a-posteriori analysis for the combined problem.  In doing so we will also present any assumptions that we deem necessary for the solvability of the problem.
\subsubsection{Framework for Stokes and Laplace}
The frame work used for the Stokes problem, which was introduced in (\ref{verf_eqns}) is 
\begin{equation}\label{frame_stokes}
\begin{aligned}
X=Y&=\left[\textbf{H}^1_0\left(\Omega\right)\right]^d\times L^2_0\left(\Omega\right),\\
\left|\left|\left(\textbf{u},p\right)\right|\right|_X&=\left\lbrace \left|\left|\nabla\textbf{u}\right|\right|^2 + \left|\left|p\right|\right|^2\right\rbrace^{1/2},\\
B\left(\left(\textbf{u},p\right),\left(\textbf{v},q\right)\right)&=\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v} - \int_{\Omega} p \nabla\cdot\textbf{v} + \int_{\Omega} q \nabla\cdot\textbf{u},\\
\langle \ell\,,\left(\textbf{v},q\right) \rangle_Y &= \int_{\Omega}\textbf{f}\cdot \textbf{v}.
\end{aligned}
\end{equation}
The framework for the discretized Stokes problem is given by 
\begin{equation}\label{frame_stokes_disc}
\begin{aligned}
X_T=Y_T&=S_0^{2,0}\left(T\right)^d\times \left(S^{1,0}\left(T\right)\cap L^2_0\left(T\right)\right),\\
B\left(\left(\textbf{u}_T,p_T\right),\left(\textbf{v}_T,q_T\right)\right)&=\int_{\Omega}\nabla \textbf{u}_T : \nabla \textbf{v}_T - \int_{\Omega} p_T \nabla\cdot\textbf{v}_T + \int_{\Omega} q_T \nabla\cdot\textbf{u}_T,\\
\langle \ell_T\,,\left(\textbf{v}_T,q_T\right) \rangle_{Y_T} &= \int_{\Omega}\textbf{f}\cdot \textbf{v}_T,
\end{aligned}
\end{equation}
where $S^{k,0}\left(T\right)^d$ is the $d-$dimensional space of continuous, $k-$th order finite element functions on the triangulation $T$.  An additional subscript $0$ indicates that the functions vanish on the boundary, $\partial \Omega$.
The framework for the Laplace problem, as used in \cite{verfurth2013posteriori} (see \S 4.2) is 
\begin{equation}\label{frame_laplace}
\begin{aligned}
X=Y&=\left[\textbf{H}^1_0\left(\Omega\right)\right]^d,\\
B\left(\textbf{u},\textbf{v}\right)&=\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v}\\
\langle \ell,\textbf{v} \rangle_Y &= \int_{\Omega}\textbf{f}\cdot \textbf{v}, 
\end{aligned}
\end{equation}
while the discretized Laplace problem is given by 
\begin{equation}\label{frame_laplace_disc}
\begin{aligned}
X_T=Y_T&=S^{k,0}_D\left(T\right)^d,\\
B_T\left(\textbf{u}_T,\textbf{v}_T\right)&=B\left(\textbf{u}_T,\textbf{v}_T\right)\\
\langle \ell_T,\textbf{v}_T \rangle_{Y_T} &=\langle \ell,\textbf{v}_T \rangle_{Y}.
\end{aligned}
\end{equation}
\subsection{Combined Framework}
In order to justify the choice of framework for the combined problem we will first look at the joint variational form.  This was given in (\ref{weak_total}) but we will include it here as well for ease of reference.  Our problem is to find $\left(\textbf{u},p\right)\in \mathbb{V}\times\mathbb{P}$ such that
\begin{equation}
\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v}-\int_{\Omega_S}p\left(\nabla \cdot \textbf{v}\right)-q\left(\nabla \cdot \textbf{u}\right)  - \int_{\mathcal{I}} \llbracket\nabla\textbf{u}-pI\rrbracket\cdot\textbf{v} =\int_{\Omega}\textbf{f}\cdot \textbf{v} \quad \forall  \textbf{v}\in \mathbb{V}
\end{equation}
is satisfied for all $\left(\textbf{v},q\right)\in \mathbb{V}\times\mathbb{P}$.  The problem here is that the pressure test functions are not defined over the whole domain.  Instead, they are defined over the Stokes part of the domain only.  In order to get over this issue we will use a trick used by \cite{BangerthHartmannKanschat2007} in Tutorial 46.  Namely, we will extend the pressure function space by zero over the entire domain.  In this way we can have pressures over the whole  domain: they are simply zero in the Laplace part.
\subsubsection{Extending the pressure space by zero}
The idea behind this notion is simple.  Firstly, we introduce the space  
\begin{equation}
\textbf{Z}=\left\lbrace  f: f\left(x\right)=0 \right\rbrace,
\end{equation}
which is the space of functions that are constant zero on a cell.  This space is zero-dimensional so for the discrete space $\textbf{Z}_T$ it holds that
\begin{equation}
\textbf{Z}_T=\textbf{Z}.\nonumber 
\end{equation}
 Now, our velocity function space remains unchanged while our pressure function space is extended over the Laplace part of the domain using $\textbf{Z}$:
\begin{equation}\label{extended_pressure_space}
\mathbb{P}=\left\lbrace p: \quad \restr{p}{{\Omega_S}}\in L^2_0\left(\Omega_S\right),\quad  \restr{p}{{\Omega_L}}\in\textbf{Z}\left(\Omega_L\right)\right\rbrace.
\end{equation}
Now we can introduce the framework we will use for the mixed problem:
\begin{equation}
\begin{aligned}
X=Y&=\mathbb{V}\times \mathbb{P},\\
\left|\left|\left(\textbf{u},p\right)\right|\right|_X&=\left\lbrace \left|\left|\nabla\textbf{u}\right|\right|^2 + \left|\left|p\right|\right|^2\right\rbrace^{1/2},\\
B\left(\left(\textbf{u},p\right),\left(\textbf{v},q\right)\right)&=\int_{\Omega}\nabla \textbf{u} : \nabla \textbf{v} - \int_{\Omega} p \nabla\cdot\textbf{v} -q \nabla\cdot\textbf{u}-\int_{\mathcal{I}} \llbracket\nabla\textbf{u}-pI\rrbracket\cdot\textbf{v},\\
\langle \ell\,,\left(\textbf{v},q\right) \rangle_Y &= \int_{\Omega}\textbf{f}\cdot \textbf{v},
\end{aligned}
\end{equation}
where 
\begin{equation}
\mathcal{I}=\overline{\Omega}_S\cap\overline{\Omega}_L.
\end{equation}
The solvability condition for the mixed problem is 
\begin{equation}
{\llbracket\nabla\textbf{u}-pI\rrbracket}|_{\mathcal{I}}=0.
\end{equation}
If we enforce this condition then Propositions \ref{prop_well_pos_verf_saddle_1} and \ref{prop_well_pos_verf_saddle} can be used to establish the well-posedness of the mixed problem in the same way as for the variational formulation of the Stokes problem.   Hence, we would also expect to be able to use a similar a-posteriori error-indicator as proposed in Theorem \ref{verf_theorem_apost_err_ind}. 

The starting point of our analysis would be the $L^2$-representation of the residual.  This would be similar to what we did for the Stokes equations in (\ref{L2-rep-residual}).   More specifically, the $L^2$-representation of the mixed problem residual would be
\begin{eqnarray}\label{L2-rep-residual-mixed}
\langle \ell -L\left(\textbf{u}_T,p_T\right),\left(\textbf{v},q\right) \rangle_Y= &\sum_{K\in T}&\int_{K}\left(\textbf{f}+\Delta \textbf{u}_T-\nabla p_T\right)\cdot \textbf{v}\nonumber\\-&\sum_{E\in \mathcal{E}_{\Omega}\setminus\mathcal{I}}&\int_{E}\llbracket\nabla \textbf{u}_T-p_TI\rrbracket \cdot \textbf{v}\\
-&\sum_{K\in T}&\int_{K}q \nabla \cdot \textbf{u}_T. \nonumber
\end{eqnarray}
The final step is to obtain the a-posteriori error indicator for the mixed problem.  We omit this procedure but it involves the sames steps we went through to get the indicator for the Stokes problem.  In the case of the mixed problem, the indicator is
\begin{equation}\small
\eta_{R,K}=\left(h^2_K\left|\left|\textbf{f}_T+\Delta \textbf{u}_T-\nabla p_T\right|\right|^2_K+\left|\left|\text{div} \textbf{u}_T\right|\right|^2_K+\frac{1}{2}\sum_{E\in\mathcal{E}_{K,\Omega}\setminus\mathcal{I}}h_E\left|\left| \llbracket \nabla \textbf{u}_T -p_T \rrbracket \right|\right|_E^2\right)^{1/2}.
\end{equation}
Compare this with the indicator given in Theorem \ref{verf_theorem_apost_err_ind} for the Stokes problem.
\section{Concluding remarks and next steps}\label{sec_conclusion}
In this report we have shown the well-posedness of the Stokes problem and of the adaptive continuous problem.  We have also implemented the Stokes problem in Deal.II in order to acquire some familiarity with this software library.  The next steps will be to carry out the a-posteriori analysis of Stokes and for adaptive Stokes and to implement the latter  in Deal.II.  

%\noindent\begin{minipage}{\textwidth} %
%	\begin{minipage}{0.5\textwidth}
%		\centering
%		\includegraphics[width=.9\linewidth]{p_h_L2.png}
%		\captionof{subfigure}{caption}
%		\label{fig:figure1}
%	\end{minipage}
%	\begin{minipage}{0.5\textwidth}
%		\centering 
%		\includegraphics[width=.9\linewidth]{u_uh_L2.png} 
%		\captionof{subfigure}{caption} 
%		\label{fig:figure2} 
%	\end{minipage}\par
%	\begin{minipage}{0.5\textwidth}
%		\centering
%		\includegraphics[width=.9\linewidth]{u_uh_H1.png}
%		\captionof{subfigure}{caption}
%		\label{fig:figure3}
%	\end{minipage}%
%	\captionof{figure}{figures} 
%	\label{fig:figures} 
%\end{minipage}
\bibliography{biblio_draft}
\bibliographystyle{ieeetr}
\end{document}